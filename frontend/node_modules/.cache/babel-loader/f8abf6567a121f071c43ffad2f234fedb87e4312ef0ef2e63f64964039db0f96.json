{"ast":null,"code":"import React,{useContext,useMemo,useRef,useState}from'react';import'./Chatbot.css';import{ShopContext}from'../../Context/ShopContext';import{Link}from'react-router-dom';import{WishlistContext}from'../../Context/WishlistContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const systemPrompts=['Ask me about products, categories, prices, or style tips. Try: \"Show women t-shirts under $30\" or \"What is this site about?\"'];const normalize=s=>String(s||'').toLowerCase();const STOPWORDS=new Set(['show','me','the','a','an','to','and','or','for','with','please','site','website','this','is','about','under','below','between','than','less','more','of','at','in','some','any','do','you','have']);const SYNONYMS=new Map([// tops\n['tshirt','t-shirt'],['tshirts','t-shirt'],['tee','t-shirt'],['tees','top'],// align to dataset terms\n['t-shirt','blouse'],['tshirts','blouse'],['tshirt','blouse'],['top','top'],['tops','top'],['blouse','blouse'],// outerwear\n['hoodies','jacket'],['hoodie','jacket'],['sweatshirt','jacket'],['sweatshirts','jacket'],['shoe','shoes'],['sneaker','shoes'],['sneakers','shoes'],['sandal','shoes'],['sandals','shoes'],['trainer','shoes'],['trainers','shoes'],['jeans','jeans'],['denim','jeans'],['trouser','pants'],['trousers','pants'],['pant','pants'],['pants','pants'],['shirt','shirt'],['shirts','shirt'],['dress','dress'],['dresses','dress'],['skirt','skirt'],['skirts','skirt'],['jacket','jacket'],['jackets','jacket'],['women','women'],['womens','women'],[\"women's\",'women'],['men','men'],['mens','men'],[\"men's\",'men'],['kid','kid'],['kids','kid']]);const CATEGORY_TERMS=['men','women','kid'];function editDistance(a,b){a=a||'';b=b||'';const dp=Array(b.length+1).fill(0).map((_,i)=>[i]);for(let j=0;j<=a.length;j++){dp[0][j]=j;}for(let i=1;i<=b.length;i++){for(let j=1;j<=a.length;j++){dp[i][j]=Math.min(dp[i-1][j]+1,dp[i][j-1]+1,dp[i-1][j-1]+(a[j-1]===b[i-1]?0:1));}}return dp[b.length][a.length];}function bestCategory(tokens){let best=null,bestScore=Infinity;for(const t of tokens){for(const cat of CATEGORY_TERMS){const d=editDistance(t,cat);if(d<bestScore){bestScore=d;best=cat;}}}return bestScore<=2?best:null;// tolerate small typos\n}function tokenize(q){return normalize(q).replace(/\\$/g,'').split(/[^a-z0-9]+/).filter(Boolean).map(t=>SYNONYMS.get(t)||t).filter(t=>!STOPWORDS.has(t));}function searchProducts(products,query){var _q$match;const q=normalize(query);const tokens=tokenize(q);// Price filters\nconst exactNumber=((_q$match=q.match(/\\$?(\\d+)/g))===null||_q$match===void 0?void 0:_q$match.map(n=>Number(n)).filter(n=>!Number.isNaN(n)))||[];let priceMin=null,priceMax=null;const betweenMatch=q.match(/between\\s*\\$?(\\d+)\\s*(and|to|-)\\s*\\$?(\\d+)/);if(betweenMatch){const a=Number(betweenMatch[1]);const b=Number(betweenMatch[3]);priceMin=Math.min(a,b);priceMax=Math.max(a,b);}else if(/under|below|less than/.test(q)&&exactNumber.length){priceMax=exactNumber[exactNumber.length-1];}else if(/over|above|more than/.test(q)&&exactNumber.length){priceMin=exactNumber[exactNumber.length-1];}// Category hints\nlet wantMen=tokens.includes('men');let wantWomen=tokens.includes('women');let wantKid=tokens.includes('kid');if(!wantMen&&!wantWomen&&!wantKid){const bc=bestCategory(tokens);if(bc==='men')wantMen=true;if(bc==='women')wantWomen=true;if(bc==='kid')wantKid=true;}// Score items\nconst scored=products.map(p=>{const name=normalize(\"\".concat(p.name,\" \").concat(p.category));const words=name.split(/[^a-z0-9]+/).filter(Boolean);let score=0;if(wantMen&&p.category==='men')score+=3;if(wantWomen&&p.category==='women')score+=3;if(wantKid&&p.category==='kid')score+=3;// direct token hits\nconst directHits=tokens.filter(t=>name.includes(t)).length;score+=directHits*2;// fuzzy hits (typo tolerance)\nfor(const t of tokens){let best=Infinity;for(const w of words){const d=editDistance(t,w);if(d<best)best=d;if(best===0)break;}if(best===1)score+=1;// minor typo\nif(best===2&&t.length>4)score+=0.5;// allow small distance for longer tokens\n}// hyphen-insensitive tshirt\nif(tokens.includes('tshirt')&&name.includes('t-shirt'))score+=2;return{p,score};});// Apply price range filter\nlet filtered=scored.filter(_ref=>{let{p}=_ref;const price=Number(p.new_price);if(priceMin!=null&&price<priceMin)return false;if(priceMax!=null&&price>priceMax)return false;return true;});// If a category term was present, hard filter to that category\nif(wantMen||wantWomen||wantKid){filtered=filtered.filter(_ref2=>{let{p}=_ref2;return wantMen&&p.category==='men'||wantWomen&&p.category==='women'||wantKid&&p.category==='kid';});}// If no tokens after stopword removal, don't overfilterâ€”just return best priced subset if price is specified\nif(tokens.length===0&&(priceMin!=null||priceMax!=null)){filtered.sort((a,b)=>a.p.new_price-b.p.new_price);return filtered.slice(0,8).map(x=>x.p);}// Sort by score desc, then price asc\nfiltered.sort((a,b)=>b.score-a.score||a.p.new_price-b.p.new_price);return filtered.filter(x=>x.score>0).slice(0,8).map(x=>x.p);}function buildAnswer(query,products){const q=normalize(query);if(!q.trim()){return{text:\"Hi! I can help you explore the store. Ask for categories, price ranges, or product names.\",items:[]};}if(!products||products.length===0){return{text:\"I am loading the catalog. Please try again in a moment or refresh the page.\",items:[]};}// Trending / new arrivals intent\nif(/(trend|trending|latest|new\\s+(arrivals|items|collection))/.test(q)){const tokens=tokenize(q);// infer category if mentioned or via typo-tolerant bestCategory\nlet wantMen=tokens.includes('men');let wantWomen=tokens.includes('women');let wantKid=tokens.includes('kid');if(!wantMen&&!wantWomen&&!wantKid){const bc=bestCategory(tokens);if(bc==='men')wantMen=true;if(bc==='women')wantWomen=true;if(bc==='kid')wantKid=true;}let pool=products;if(wantMen)pool=pool.filter(p=>p.category==='men');if(wantWomen)pool=pool.filter(p=>p.category==='women');if(wantKid)pool=pool.filter(p=>p.category==='kid');// Heuristic: consider higher IDs as newer; otherwise randomize\nconst trending=[...pool].sort((a,b)=>b.id-a.id||a.new_price-b.new_price).slice(0,6);if(trending.length){const scope=wantMen?'men':wantWomen?'women':wantKid?'kids':'all';return{text:\"Trending \".concat(scope,\" picks right now:\"),items:trending};}return{text:\"I couldn't find trending items for that category.\",items:[]};}if(/what\\s+is\\s+(this|the)\\s+(site|website)/.test(q)||/about\\s+this\\s+website/.test(q)){return{text:\"This is an eâ€‘commerce store for fashion items across Men, Women, and Kids. You can browse categories, compare prices, try items virtually, add to cart, and save favorites in your wishlist.\",items:[]};}if(/hello|hi|hey/.test(q)){return{text:\"Hello! Ask me for products (e.g., 'women tâ€‘shirts under $30') or say a category like 'mens hoodies'.\",items:[]};}const results=searchProducts(products,query).slice(0,6);if(results.length===0){// Smart fallback: suggest popular/cheapest in a hinted category or global\nconst tokens=tokenize(q);const wantMen=tokens.includes('men');const wantWomen=tokens.includes('women');const wantKid=tokens.includes('kid');let pool=products;if(wantMen)pool=products.filter(p=>p.category==='men');if(wantWomen)pool=products.filter(p=>p.category==='women');if(wantKid)pool=products.filter(p=>p.category==='kid');const suggestions=[...pool].sort((a,b)=>a.new_price-b.new_price).slice(0,6);if(suggestions.length){return{text:\"I couldn't find an exact match. Here are some close suggestions:\",items:suggestions};}return{text:\"I couldn't find matching items. Try changing the category or price range.\",items:[]};}return{text:\"Here are some matches (\".concat(results.length,\" shown):\"),items:results};}export const Chatbot=()=>{const{all_product}=useContext(ShopContext);const{toggleWishlist,isWishlisted}=useContext(WishlistContext);const[open,setOpen]=useState(false);const[input,setInput]=useState('');const[messages,setMessages]=useState([{role:'system',content:systemPrompts[0]},{role:'assistant',content:'Hi! I\\'m your shopping assistant. How can I help?'}]);const listRef=useRef(null);const[thinking,setThinking]=useState(false);const[context,setContext]=useState({lastCategory:null,lastPriceMin:null,lastPriceMax:null});const isLoggedIn=!!localStorage.getItem('auth-token');const handleAsk=()=>{const q=input.trim();if(!q)return;const userMsg={role:'user',content:q};setMessages(prev=>[...prev,userMsg]);setThinking(true);setInput('');setTimeout(()=>{const answer=buildAnswer(q,all_product);const botMsg={role:'assistant',content:answer.text,items:answer.items};setMessages(prev=>[...prev,botMsg]);setThinking(false);setTimeout(()=>{if(listRef.current)listRef.current.scrollTop=listRef.current.scrollHeight;},0);},150);// brief delay for UX\n};const quickChips=useMemo(()=>['Show women t-shirts under $30','mens hoodies','kids shoes between $20 and $50','trending now','what is this website?'],[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"chatbot-root\",children:[!open&&/*#__PURE__*/_jsx(\"button\",{className:\"chatbot-fab\",onClick:()=>setOpen(true),\"aria-label\":\"Open assistant\",children:\"\\uD83D\\uDCAC\"}),open&&/*#__PURE__*/_jsxs(\"div\",{className:\"chatbot-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chatbot-header\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Shop Assistant\"}),/*#__PURE__*/_jsx(\"button\",{className:\"chatbot-close\",onClick:()=>setOpen(false),\"aria-label\":\"Close\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chatbot-body\",ref:listRef,children:[messages.map((m,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"msg msg-\".concat(m.role),children:[/*#__PURE__*/_jsx(\"div\",{className:\"msg-text\",children:m.content}),Array.isArray(m.items)&&m.items.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"results\",children:m.items.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"result-card \".concat(!isLoggedIn?'result-card-disabled':''),children:[isLoggedIn?/*#__PURE__*/_jsxs(Link,{to:\"/product/\".concat(item.id),className:\"rc-link\",onClick:()=>setOpen(false),children:[/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-meta\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rc-name\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-price\",children:[\"$\",item.new_price]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"rc-link disabled\",title:\"Login to explore details\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-meta\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rc-name\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-price\",children:[\"$\",item.new_price]}),/*#__PURE__*/_jsx(\"div\",{className:\"rc-note\",children:\"Login to view details\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"rc-wish \".concat(!isLoggedIn?'rc-wish-disabled':''),onClick:()=>{if(isLoggedIn)toggleWishlist(item.id,item);},\"aria-label\":isWishlisted(item.id)?'Remove from wishlist':'Add to wishlist',disabled:!isLoggedIn,title:!isLoggedIn?'Login to use wishlist':'',children:isWishlisted(item.id)?'â™¥':'â™¡'}),!isLoggedIn&&/*#__PURE__*/_jsx(Link,{className:\"rc-login\",to:\"/login\",onClick:()=>setOpen(false),children:\"Login\"})]})]},item.id))})]},idx)),thinking&&/*#__PURE__*/_jsx(\"div\",{className:\"msg msg-assistant\",children:/*#__PURE__*/_jsx(\"div\",{className:\"msg-text\",children:\"Thinking\\u2026\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chatbot-chips\",children:quickChips.map(c=>/*#__PURE__*/_jsx(\"button\",{className:\"chip\",onClick:()=>{setInput(c);},children:c},c))}),/*#__PURE__*/_jsxs(\"div\",{className:\"chatbot-input\",children:[/*#__PURE__*/_jsx(\"input\",{value:input,onChange:e=>setInput(e.target.value),placeholder:\"Ask about products, categories, or price...\",onKeyDown:e=>{if(e.key==='Enter')handleAsk();}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAsk,children:\"Send\"})]})]})]});};export default Chatbot;","map":{"version":3,"names":["React","useContext","useMemo","useRef","useState","ShopContext","Link","WishlistContext","jsx","_jsx","jsxs","_jsxs","systemPrompts","normalize","s","String","toLowerCase","STOPWORDS","Set","SYNONYMS","Map","CATEGORY_TERMS","editDistance","a","b","dp","Array","length","fill","map","_","i","j","Math","min","bestCategory","tokens","best","bestScore","Infinity","t","cat","d","tokenize","q","replace","split","filter","Boolean","get","has","searchProducts","products","query","_q$match","exactNumber","match","n","Number","isNaN","priceMin","priceMax","betweenMatch","max","test","wantMen","includes","wantWomen","wantKid","bc","scored","p","name","concat","category","words","score","directHits","w","filtered","_ref","price","new_price","_ref2","sort","slice","x","buildAnswer","trim","text","items","pool","trending","id","scope","results","suggestions","Chatbot","all_product","toggleWishlist","isWishlisted","open","setOpen","input","setInput","messages","setMessages","role","content","listRef","thinking","setThinking","context","setContext","lastCategory","lastPriceMin","lastPriceMax","isLoggedIn","localStorage","getItem","handleAsk","userMsg","prev","setTimeout","answer","botMsg","current","scrollTop","scrollHeight","quickChips","className","children","onClick","ref","m","idx","isArray","item","to","src","image","alt","title","disabled","c","value","onChange","e","target","placeholder","onKeyDown","key"],"sources":["D:/ec/E_Commerence/frontend/src/Components/Chatbot/Chatbot.jsx"],"sourcesContent":["import React, { useContext, useMemo, useRef, useState } from 'react';\nimport './Chatbot.css';\nimport { ShopContext } from '../../Context/ShopContext';\nimport { Link } from 'react-router-dom';\nimport { WishlistContext } from '../../Context/WishlistContext';\n\nconst systemPrompts = [\n  'Ask me about products, categories, prices, or style tips. Try: \"Show women t-shirts under $30\" or \"What is this site about?\"'\n];\n\nconst normalize = (s) => String(s || '').toLowerCase();\nconst STOPWORDS = new Set(['show','me','the','a','an','to','and','or','for','with','please','site','website','this','is','about','under','below','between','than','less','more','of','at','in','some','any','do','you','have']);\nconst SYNONYMS = new Map([\n  // tops\n  ['tshirt','t-shirt'], ['tshirts','t-shirt'], ['tee','t-shirt'], ['tees','top'],\n  // align to dataset terms\n  ['t-shirt','blouse'], ['tshirts','blouse'], ['tshirt','blouse'],\n  ['top','top'], ['tops','top'], ['blouse','blouse'],\n  // outerwear\n  ['hoodies','jacket'], ['hoodie','jacket'], ['sweatshirt','jacket'], ['sweatshirts','jacket'],\n  ['shoe','shoes'], ['sneaker','shoes'], ['sneakers','shoes'],\n  ['sandal','shoes'], ['sandals','shoes'], ['trainer','shoes'], ['trainers','shoes'],\n  ['jeans','jeans'], ['denim','jeans'], ['trouser','pants'], ['trousers','pants'], ['pant','pants'], ['pants','pants'],\n  ['shirt','shirt'], ['shirts','shirt'], ['dress','dress'], ['dresses','dress'], ['skirt','skirt'], ['skirts','skirt'], ['jacket','jacket'], ['jackets','jacket'],\n  ['women','women'], ['womens','women'], [\"women's\",'women'],\n  ['men','men'], ['mens','men'], [\"men's\",'men'],\n  ['kid','kid'], ['kids','kid'],\n]);\n\nconst CATEGORY_TERMS = ['men','women','kid'];\n\nfunction editDistance(a,b){\n  a = a || ''; b = b || '';\n  const dp = Array(b.length+1).fill(0).map((_,i)=>[i]);\n  for(let j=0;j<=a.length;j++){ dp[0][j]=j; }\n  for(let i=1;i<=b.length;i++){\n    for(let j=1;j<=a.length;j++){\n      dp[i][j] = Math.min(\n        dp[i-1][j] + 1,\n        dp[i][j-1] + 1,\n        dp[i-1][j-1] + (a[j-1]===b[i-1]?0:1)\n      );\n    }\n  }\n  return dp[b.length][a.length];\n}\n\nfunction bestCategory(tokens){\n  let best = null, bestScore = Infinity;\n  for(const t of tokens){\n    for(const cat of CATEGORY_TERMS){\n      const d = editDistance(t, cat);\n      if(d < bestScore){ bestScore = d; best = cat; }\n    }\n  }\n  return bestScore <= 2 ? best : null; // tolerate small typos\n}\n\nfunction tokenize(q){\n  return normalize(q)\n    .replace(/\\$/g,'')\n    .split(/[^a-z0-9]+/)\n    .filter(Boolean)\n    .map(t=>SYNONYMS.get(t) || t)\n    .filter(t=>!STOPWORDS.has(t));\n}\n\nfunction searchProducts(products, query) {\n  const q = normalize(query);\n  const tokens = tokenize(q);\n\n  // Price filters\n  const exactNumber = q.match(/\\$?(\\d+)/g)?.map(n=>Number(n)).filter(n=>!Number.isNaN(n)) || [];\n  let priceMin = null, priceMax = null;\n  const betweenMatch = q.match(/between\\s*\\$?(\\d+)\\s*(and|to|-)\\s*\\$?(\\d+)/);\n  if (betweenMatch) {\n    const a = Number(betweenMatch[1]);\n    const b = Number(betweenMatch[3]);\n    priceMin = Math.min(a,b); priceMax = Math.max(a,b);\n  } else if (/under|below|less than/.test(q) && exactNumber.length){\n    priceMax = exactNumber[exactNumber.length-1];\n  } else if (/over|above|more than/.test(q) && exactNumber.length){\n    priceMin = exactNumber[exactNumber.length-1];\n  }\n\n  // Category hints\n  let wantMen = tokens.includes('men');\n  let wantWomen = tokens.includes('women');\n  let wantKid = tokens.includes('kid');\n  if(!wantMen && !wantWomen && !wantKid){\n    const bc = bestCategory(tokens);\n    if (bc==='men') wantMen = true;\n    if (bc==='women') wantWomen = true;\n    if (bc==='kid') wantKid = true;\n  }\n\n  // Score items\n  const scored = products.map(p=>{\n    const name = normalize(`${p.name} ${p.category}`);\n    const words = name.split(/[^a-z0-9]+/).filter(Boolean);\n    let score = 0;\n    if (wantMen && p.category === 'men') score += 3;\n    if (wantWomen && p.category === 'women') score += 3;\n    if (wantKid && p.category === 'kid') score += 3;\n    // direct token hits\n    const directHits = tokens.filter(t=>name.includes(t)).length;\n    score += directHits * 2;\n    // fuzzy hits (typo tolerance)\n    for (const t of tokens){\n      let best = Infinity;\n      for (const w of words){\n        const d = editDistance(t, w);\n        if (d < best) best = d;\n        if (best === 0) break;\n      }\n      if (best === 1) score += 1; // minor typo\n      if (best === 2 && t.length > 4) score += 0.5; // allow small distance for longer tokens\n    }\n    // hyphen-insensitive tshirt\n    if (tokens.includes('tshirt') && name.includes('t-shirt')) score += 2;\n    return { p, score };\n  });\n\n  // Apply price range filter\n  let filtered = scored.filter(({p})=>{\n    const price = Number(p.new_price);\n    if (priceMin!=null && price < priceMin) return false;\n    if (priceMax!=null && price > priceMax) return false;\n    return true;\n  });\n\n  // If a category term was present, hard filter to that category\n  if (wantMen || wantWomen || wantKid){\n    filtered = filtered.filter(({p})=>\n      (wantMen && p.category==='men') || (wantWomen && p.category==='women') || (wantKid && p.category==='kid')\n    );\n  }\n\n  // If no tokens after stopword removal, don't overfilterâ€”just return best priced subset if price is specified\n  if (tokens.length === 0 && (priceMin!=null || priceMax!=null)){\n    filtered.sort((a,b)=> (a.p.new_price - b.p.new_price));\n    return filtered.slice(0,8).map(x=>x.p);\n  }\n\n  // Sort by score desc, then price asc\n  filtered.sort((a,b)=> b.score - a.score || (a.p.new_price - b.p.new_price));\n  return filtered.filter(x=>x.score>0).slice(0,8).map(x=>x.p);\n}\n\nfunction buildAnswer(query, products) {\n  const q = normalize(query);\n  if (!q.trim()) {\n    return { text: \"Hi! I can help you explore the store. Ask for categories, price ranges, or product names.\", items: [] };\n  }\n  if (!products || products.length === 0){\n    return { text: \"I am loading the catalog. Please try again in a moment or refresh the page.\", items: [] };\n  }\n  // Trending / new arrivals intent\n  if (/(trend|trending|latest|new\\s+(arrivals|items|collection))/.test(q)) {\n    const tokens = tokenize(q);\n    // infer category if mentioned or via typo-tolerant bestCategory\n    let wantMen = tokens.includes('men');\n    let wantWomen = tokens.includes('women');\n    let wantKid = tokens.includes('kid');\n    if(!wantMen && !wantWomen && !wantKid){\n      const bc = bestCategory(tokens);\n      if (bc==='men') wantMen = true;\n      if (bc==='women') wantWomen = true;\n      if (bc==='kid') wantKid = true;\n    }\n    let pool = products;\n    if (wantMen) pool = pool.filter(p=>p.category==='men');\n    if (wantWomen) pool = pool.filter(p=>p.category==='women');\n    if (wantKid) pool = pool.filter(p=>p.category==='kid');\n    // Heuristic: consider higher IDs as newer; otherwise randomize\n    const trending = [...pool].sort((a,b)=> (b.id - a.id) || (a.new_price - b.new_price)).slice(0,6);\n    if (trending.length) {\n      const scope = wantMen? 'men' : wantWomen? 'women' : wantKid? 'kids' : 'all';\n      return { text: `Trending ${scope} picks right now:`, items: trending };\n    }\n    return { text: \"I couldn't find trending items for that category.\", items: [] };\n  }\n  if (/what\\s+is\\s+(this|the)\\s+(site|website)/.test(q) || /about\\s+this\\s+website/.test(q)) {\n    return { text: \"This is an eâ€‘commerce store for fashion items across Men, Women, and Kids. You can browse categories, compare prices, try items virtually, add to cart, and save favorites in your wishlist.\", items: [] };\n  }\n  if (/hello|hi|hey/.test(q)) {\n    return { text: \"Hello! Ask me for products (e.g., 'women tâ€‘shirts under $30') or say a category like 'mens hoodies'.\", items: [] };\n  }\n\n  const results = searchProducts(products, query).slice(0, 6);\n  if (results.length === 0) {\n    // Smart fallback: suggest popular/cheapest in a hinted category or global\n    const tokens = tokenize(q);\n    const wantMen = tokens.includes('men');\n    const wantWomen = tokens.includes('women');\n    const wantKid = tokens.includes('kid');\n    let pool = products;\n    if (wantMen) pool = products.filter(p=>p.category==='men');\n    if (wantWomen) pool = products.filter(p=>p.category==='women');\n    if (wantKid) pool = products.filter(p=>p.category==='kid');\n    const suggestions = [...pool].sort((a,b)=> (a.new_price - b.new_price)).slice(0,6);\n    if (suggestions.length){\n      return { text: \"I couldn't find an exact match. Here are some close suggestions:\", items: suggestions };\n    }\n    return { text: \"I couldn't find matching items. Try changing the category or price range.\", items: [] };\n  }\n  return { text: `Here are some matches (${results.length} shown):`, items: results };\n}\n\nexport const Chatbot = () => {\n  const { all_product } = useContext(ShopContext);\n  const { toggleWishlist, isWishlisted } = useContext(WishlistContext);\n  const [open, setOpen] = useState(false);\n  const [input, setInput] = useState('');\n  const [messages, setMessages] = useState([\n    { role: 'system', content: systemPrompts[0] },\n    { role: 'assistant', content: 'Hi! I\\'m your shopping assistant. How can I help?' }\n  ]);\n  const listRef = useRef(null);\n  const [thinking, setThinking] = useState(false);\n  const [context, setContext] = useState({ lastCategory: null, lastPriceMin: null, lastPriceMax: null });\n  const isLoggedIn = !!localStorage.getItem('auth-token');\n\n  const handleAsk = () => {\n    const q = input.trim();\n    if (!q) return;\n    const userMsg = { role: 'user', content: q };\n    setMessages(prev => [...prev, userMsg]);\n    setThinking(true);\n    setInput('');\n    setTimeout(() => {\n      const answer = buildAnswer(q, all_product);\n      const botMsg = { role: 'assistant', content: answer.text, items: answer.items };\n      setMessages(prev => [...prev, botMsg]);\n      setThinking(false);\n      setTimeout(() => {\n        if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n      }, 0);\n    }, 150); // brief delay for UX\n  };\n\n  const quickChips = useMemo(() => [\n    'Show women t-shirts under $30',\n    'mens hoodies',\n    'kids shoes between $20 and $50',\n    'trending now',\n    'what is this website?',\n  ], []);\n\n  return (\n    <div className=\"chatbot-root\">\n      {!open && (\n        <button className=\"chatbot-fab\" onClick={() => setOpen(true)} aria-label=\"Open assistant\">\n          ðŸ’¬\n        </button>\n      )}\n      {open && (\n        <div className=\"chatbot-panel\">\n          <div className=\"chatbot-header\">\n            <strong>Shop Assistant</strong>\n            <button className=\"chatbot-close\" onClick={() => setOpen(false)} aria-label=\"Close\">Ã—</button>\n          </div>\n          <div className=\"chatbot-body\" ref={listRef}>\n            {messages.map((m, idx) => (\n              <div key={idx} className={`msg msg-${m.role}`}>\n                <div className=\"msg-text\">{m.content}</div>\n                {Array.isArray(m.items) && m.items.length > 0 && (\n                  <div className=\"results\">\n                    {m.items.map(item => (\n                      <div key={item.id} className={`result-card ${!isLoggedIn ? 'result-card-disabled' : ''}`}>\n                        {isLoggedIn ? (\n                          <Link to={`/product/${item.id}`} className=\"rc-link\" onClick={() => setOpen(false)}>\n                            <img src={item.image} alt={item.name} />\n                            <div className=\"rc-meta\">\n                              <div className=\"rc-name\">{item.name}</div>\n                              <div className=\"rc-price\">${item.new_price}</div>\n                            </div>\n                          </Link>\n                        ) : (\n                          <div className=\"rc-link disabled\" title=\"Login to explore details\">\n                            <img src={item.image} alt={item.name} />\n                            <div className=\"rc-meta\">\n                              <div className=\"rc-name\">{item.name}</div>\n                              <div className=\"rc-price\">${item.new_price}</div>\n                              <div className=\"rc-note\">Login to view details</div>\n                            </div>\n                          </div>\n                        )}\n                        <div className=\"rc-actions\">\n                          <button\n                            className={`rc-wish ${!isLoggedIn ? 'rc-wish-disabled' : ''}`}\n                            onClick={() => { if (isLoggedIn) toggleWishlist(item.id, item); }}\n                            aria-label={isWishlisted(item.id) ? 'Remove from wishlist' : 'Add to wishlist'}\n                            disabled={!isLoggedIn}\n                            title={!isLoggedIn ? 'Login to use wishlist' : ''}\n                          >\n                            {isWishlisted(item.id) ? 'â™¥' : 'â™¡'}\n                          </button>\n                          {!isLoggedIn && (\n                            <Link className=\"rc-login\" to=\"/login\" onClick={() => setOpen(false)}>Login</Link>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))}\n            {thinking && (\n              <div className=\"msg msg-assistant\"><div className=\"msg-text\">Thinkingâ€¦</div></div>\n            )}\n          </div>\n          <div className=\"chatbot-chips\">\n            {quickChips.map((c) => (\n              <button key={c} className=\"chip\" onClick={() => { setInput(c); }}>\n                {c}\n              </button>\n            ))}\n          </div>\n          <div className=\"chatbot-input\">\n            <input\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              placeholder=\"Ask about products, categories, or price...\"\n              onKeyDown={(e) => { if (e.key === 'Enter') handleAsk(); }}\n            />\n            <button onClick={handleAsk}>Send</button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Chatbot;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}