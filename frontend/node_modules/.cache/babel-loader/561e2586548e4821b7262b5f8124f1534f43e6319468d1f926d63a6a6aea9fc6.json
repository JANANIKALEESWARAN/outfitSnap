{"ast":null,"code":"var _jsxFileName = \"D:\\\\ec\\\\E_Commerence\\\\frontend\\\\src\\\\Components\\\\VirtualTryOn\\\\VirtualTryOn.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport \"./VirtualTryOn.css\";\n\n/*\n  VirtualTryOn component\n  - User can upload a photo or use camera\n  - Product image is overlaid on top with controls (move/scale/rotate)\n  - Download the composed image\n  - Reuses parent add-to-cart logic via onAddToCart prop\n*/\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst constraints = {\n  video: {\n    width: 640,\n    height: 480\n  },\n  audio: false\n};\nexport const VirtualTryOn = ({\n  productImage,\n  productMaskImage,\n  productName,\n  onAddToCart,\n  isLoggedIn\n}) => {\n  _s();\n  const [mode, setMode] = useState(\"upload\"); // 'upload' | 'camera'\n  const [bgImage, setBgImage] = useState(null); // Image element for user's photo\n  const [overlay, setOverlay] = useState({\n    scale: 1,\n    scaleY: 1,\n    shearY: 0,\n    warp: 0.15,\n    rotation: 0,\n    x: 0,\n    y: 0,\n    neckX: null,\n    neckY: null,\n    shoulderW: null\n  });\n  const [canvasSize, setCanvasSize] = useState({\n    width: 640,\n    height: 480\n  });\n  const [poseReady, setPoseReady] = useState(false);\n  const [segReady, setSegReady] = useState(false);\n  const [handsReady, setHandsReady] = useState(false);\n  const [enableOcclusion, setEnableOcclusion] = useState(true);\n  const [autoRemoveBg, setAutoRemoveBg] = useState(true);\n  const [showGuides, setShowGuides] = useState(false);\n  const [userHeightCm, setUserHeightCm] = useState(170);\n  const videoRef = useRef(null);\n  const streamRef = useRef(null);\n  const canvasRef = useRef(null);\n  const productImgRef = useRef(null);\n  const maskImgRef = useRef(null);\n  const garmentCanvasRef = useRef(null); // cached masked garment\n  const poseRef = useRef(null);\n  const segRef = useRef(null);\n  const handsRef = useRef(null);\n  const rafRef = useRef(null);\n\n  // Build masked garment canvas from product image and optional mask\n  const prepareGarmentBitmap = () => {\n    try {\n      const img = productImgRef.current;\n      if (!img || !img.naturalWidth) return;\n      const w = img.naturalWidth,\n        h = img.naturalHeight;\n      const gc = document.createElement('canvas');\n      gc.width = w;\n      gc.height = h;\n      const gctx = gc.getContext('2d');\n      gctx.drawImage(img, 0, 0);\n\n      // If we have a precomputed mask image, apply it\n      const maskImg = maskImgRef.current;\n      if (maskImg && maskImg.naturalWidth) {\n        gctx.globalCompositeOperation = 'destination-in';\n        gctx.drawImage(maskImg, 0, 0, w, h);\n        gctx.globalCompositeOperation = 'source-over';\n        garmentCanvasRef.current = gc;\n        return;\n      }\n\n      // Auto-generate mask by sampling corner background and thresholding\n      const imgData = gctx.getImageData(0, 0, w, h);\n      const d = imgData.data;\n      const sample = (x, y) => {\n        const i = (y * w + x) * 4;\n        return [d[i], d[i + 1], d[i + 2]];\n      };\n      const corners = [sample(2, 2), sample(w - 3, 2), sample(2, h - 3), sample(w - 3, h - 3)];\n      const avg = corners.reduce((a, c) => [a[0] + c[0], a[1] + c[1], a[2] + c[2]], [0, 0, 0]).map(v => v / 4);\n      const dist = (r, g, b) => Math.hypot(r - avg[0], g - avg[1], b - avg[2]);\n      const T = 40;\n      for (let i = 0; i < d.length; i += 4) {\n        const r = d[i],\n          g = d[i + 1],\n          b = d[i + 2];\n        const nearBg = dist(r, g, b) < T || r > 240 && g > 240 && b > 240;\n        if (nearBg) d[i + 3] = 0;\n      }\n      const aCopy = new Uint8ClampedArray(d);\n      const idx = (x, y) => (y * w + x) * 4 + 3;\n      for (let y = 1; y < h - 1; y++) {\n        for (let x = 1; x < w - 1; x++) {\n          const a = aCopy[idx(x, y)];\n          if (a === 0) continue;\n          let hole = 0;\n          if (aCopy[idx(x - 1, y)] === 0) hole++;\n          if (aCopy[idx(x + 1, y)] === 0) hole++;\n          if (aCopy[idx(x, y - 1)] === 0) hole++;\n          if (aCopy[idx(x, y + 1)] === 0) hole++;\n          if (hole > 0) d[idx(x, y)] = Math.min(200, a);\n        }\n      }\n      gctx.putImageData(imgData, 0, 0);\n      garmentCanvasRef.current = gc;\n    } catch (e) {}\n  };\n\n  // Auto fit garment using pose landmarks\n  const autoFit = async () => {\n    try {\n      if (!poseRef.current) return;\n      const canvas = document.createElement(\"canvas\");\n      canvas.width = canvasSize.width;\n      canvas.height = canvasSize.height;\n      const ctx = canvas.getContext(\"2d\");\n      if (bgImage) {\n        // draw with aspect preserved like render loop\n        const scale = Math.min(canvas.width / bgImage.width, canvas.height / bgImage.height);\n        const drawW = bgImage.width * scale;\n        const drawH = bgImage.height * scale;\n        const offsetX = (canvas.width - drawW) / 2;\n        const offsetY = (canvas.height - drawH) / 2;\n        ctx.drawImage(bgImage, offsetX, offsetY, drawW, drawH);\n      } else if (mode === \"camera\" && videoRef.current) {\n        ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n      } else {\n        alert('No image available to detect. Upload or capture a photo.');\n        return;\n      }\n      const p = poseRef.current;\n      let landmarks = null;\n      await new Promise(resolve => {\n        p.onResults(res => {\n          landmarks = res.poseLandmarks;\n          resolve();\n        });\n        p.send({\n          image: canvas\n        });\n      });\n      if (!landmarks || landmarks.length < 25) {\n        alert('Could not detect body landmarks. Try another photo facing camera.');\n        return;\n      }\n      const L = landmarks;\n      const w = canvas.width,\n        h = canvas.height;\n      let ls = L[11],\n        rs = L[12];\n      // Fallback: estimate shoulders from ears if needed\n      if ((!ls || !rs) && L[7] && L[8]) {\n        const le = L[7],\n          re = L[8];\n        const ex1 = (le.x || 0) * w,\n          ey1 = (le.y || 0) * h;\n        const ex2 = (re.x || 0) * w,\n          ey2 = (re.y || 0) * h;\n        const earW = Math.hypot(ex1 - ex2, ey1 - ey2);\n        const midx = (ex1 + ex2) / 2,\n          midy = (ey1 + ey2) / 2 + earW * 0.9; // move down from ears to approx shoulders\n        ls = {\n          x: (midx - earW * 0.9) / w,\n          y: midy / h\n        };\n        rs = {\n          x: (midx + earW * 0.9) / w,\n          y: midy / h\n        };\n      }\n      if (!ls || !rs) {\n        alert('Shoulders not found. Ensure your shoulders are visible.');\n        return;\n      }\n      const sx = (ls.x || 0) * w,\n        sy = (ls.y || 0) * h;\n      const rx = (rs.x || 0) * w,\n        ry = (rs.y || 0) * h;\n      const mx = (sx + rx) / 2,\n        my = (sy + ry) / 2;\n      const shoulderW = Math.max(10, Math.hypot(sx - rx, sy - ry));\n      const base = Math.min(w, h) * 0.6;\n      const desiredOverlayW = shoulderW * 1.8;\n      const scale = Math.max(0.3, Math.min(1.8, desiredOverlayW / Math.max(base, 1)));\n      const angleDeg = Math.atan2(ry - sy, rx - sx) * 180 / Math.PI;\n      let torsoLen = shoulderW * 1.2;\n      const lh = L[23],\n        rh = L[24];\n      if (lh && rh) {\n        const hx = ((lh.x || 0) + (rh.x || 0)) / 2 * w;\n        const hy = ((lh.y || 0) + (rh.y || 0)) / 2 * h;\n        torsoLen = Math.max(shoulderW * 0.8, Math.hypot(mx - hx, my - hy));\n      }\n      const scaleY = Math.max(0.8, Math.min(1.6, torsoLen / Math.max(shoulderW, 1)));\n      // shearY based on shoulder vertical difference before rotation\n      const shoulderDy = ry - sy;\n      const shearY = Math.max(-0.3, Math.min(0.3, shoulderDy / Math.max(shoulderW, 1) * 0.8));\n      const cx = w / 2,\n        cy = h / 2;\n      // Estimate neck Y using nose and ears\n      const nose = L[0];\n      let neckY = my; // fallback: shoulder mid\n      if (nose) {\n        const noseY = (nose.y || 0) * h;\n        neckY = Math.min(my - shoulderW * 0.15, noseY + shoulderW * 0.35);\n      }\n      // convert neck target to overlay offset relative to canvas center\n      const targetY = neckY;\n      // place garment so collar sits near neck target (heuristic offset)\n      const yOffset = my - targetY + shoulderW * 0.5;\n      setOverlay(o => ({\n        ...o,\n        x: Math.round(mx - cx),\n        y: Math.round(my - cy - yOffset),\n        scale,\n        scaleY,\n        shearY,\n        rotation: Math.round(angleDeg),\n        neckX: mx,\n        neckY: neckY,\n        shoulderW\n      }));\n    } catch (e) {}\n  };\n\n  // Camera handling\n  useEffect(() => {\n    const startCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(constraints);\n        streamRef.current = stream;\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n        setCanvasSize({\n          width: constraints.video.width,\n          height: constraints.video.height\n        });\n      } catch (err) {\n        console.error(\"Camera error:\", err);\n        alert(\"Unable to access camera. Please allow permission or use Upload mode.\");\n        setMode(\"upload\");\n      }\n    };\n    const stopCamera = () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(t => t.stop());\n        streamRef.current = null;\n      }\n    };\n    if (mode === \"camera\") startCamera();else stopCamera();\n    return () => stopCamera();\n  }, [mode]);\n  useEffect(() => {\n    if (window.Pose || window.pose) return;\n    const s = document.createElement(\"script\");\n    s.src = \"https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js\";\n    s.async = true;\n    s.onload = () => {\n      try {\n        const Pose = window.Pose || window.pose;\n        if (!Pose || !Pose.Pose) return;\n        const p = new Pose.Pose({\n          locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`\n        });\n        p.setOptions({\n          modelComplexity: 0,\n          selfieMode: true,\n          smoothLandmarks: true,\n          enableSegmentation: false\n        });\n        poseRef.current = p;\n        setPoseReady(true);\n      } catch (e) {}\n    };\n    document.body.appendChild(s);\n  }, []);\n\n  // Load MediaPipe Hands to reinforce occlusion for hands/arms\n  useEffect(() => {\n    if (window.Hands || window.hands) return;\n    const s = document.createElement('script');\n    s.src = 'https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js';\n    s.async = true;\n    s.onload = () => {\n      try {\n        const Hands = window.Hands || window.hands;\n        if (!Hands || !Hands.Hands) return;\n        const h = new Hands.Hands({\n          locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`\n        });\n        h.setOptions({\n          selfieMode: true,\n          maxNumHands: 2,\n          modelComplexity: 1,\n          minDetectionConfidence: 0.5,\n          minTrackingConfidence: 0.5\n        });\n        handsRef.current = h;\n        setHandsReady(true);\n      } catch (e) {}\n    };\n    document.body.appendChild(s);\n  }, []);\n  useEffect(() => {\n    if (window.SelfieSegmentation || window.selfieSegmentation) return;\n    const s = document.createElement(\"script\");\n    s.src = \"https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js\";\n    s.async = true;\n    s.onload = () => {\n      try {\n        const SS = window.SelfieSegmentation || window.selfieSegmentation;\n        if (!SS || !SS.SelfieSegmentation) return;\n        const seg = new SS.SelfieSegmentation({\n          locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${file}`\n        });\n        seg.setOptions({\n          modelSelection: 1\n        }); // landscape general\n        segRef.current = seg;\n        setSegReady(true);\n        setEnableOcclusion(true);\n      } catch (e) {}\n    };\n    document.body.appendChild(s);\n  }, []);\n\n  // File upload -> load as Image\n  const onFileChange = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      const img = new Image();\n      img.onload = () => {\n        setBgImage(img);\n        const maxW = 800,\n          maxH = 800;\n        let w = img.width,\n          h = img.height;\n        const ratio = Math.min(maxW / w, maxH / h, 1);\n        setCanvasSize({\n          width: Math.round(w * ratio),\n          height: Math.round(h * ratio)\n        });\n      };\n      img.src = reader.result;\n    };\n    reader.readAsDataURL(file);\n  };\n\n  // Capture from camera\n  const captureFromCamera = () => {\n    if (!videoRef.current) return;\n    const {\n      videoWidth: w,\n      videoHeight: h\n    } = videoRef.current;\n    setCanvasSize({\n      width: w,\n      height: h\n    });\n    const temp = document.createElement(\"canvas\");\n    temp.width = w;\n    temp.height = h;\n    const ctx = temp.getContext(\"2d\");\n    ctx.drawImage(videoRef.current, 0, 0, w, h);\n    const img = new Image();\n    img.onload = () => setBgImage(img);\n    img.src = temp.toDataURL(\"image/png\");\n  };\n\n  // Draw composition with rAF and optional occlusion\n  useEffect(() => {\n    const {\n      width,\n      height\n    } = canvasSize; // for lint dependency clarity\n    const draw = async () => {\n      const canvas = canvasRef.current;\n      const ctx = canvas === null || canvas === void 0 ? void 0 : canvas.getContext(\"2d\");\n      if (!canvas || !ctx) return;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      // 1) capture background frame\n      let frameCanvas = document.createElement(\"canvas\");\n      frameCanvas.width = canvas.width;\n      frameCanvas.height = canvas.height;\n      const fctx = frameCanvas.getContext(\"2d\");\n      if (bgImage) {\n        const scale = Math.min(canvas.width / bgImage.width, canvas.height / bgImage.height);\n        const drawW = bgImage.width * scale;\n        const drawH = bgImage.height * scale;\n        const offsetX = (canvas.width - drawW) / 2;\n        const offsetY = (canvas.height - drawH) / 2;\n        fctx.drawImage(bgImage, offsetX, offsetY, drawW, drawH);\n        ctx.drawImage(frameCanvas, 0, 0);\n      } else if (mode === \"camera\" && videoRef.current && !videoRef.current.paused) {\n        fctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        ctx.drawImage(frameCanvas, 0, 0);\n      } else {\n        ctx.fillStyle = \"#f5f5f5\";\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n      }\n\n      // 2) draw garment overlay (use prepared garment canvas)\n      const productImg = productImgRef.current;\n      if (productImg) {\n        let garment = garmentCanvasRef.current || productImg;\n        const baseSize = Math.min(canvas.width, canvas.height) * 0.6;\n        const overlayW = baseSize * (overlay.scale || 1);\n        const aspect = (garment.height || productImg.naturalHeight) / Math.max(garment.width || productImg.naturalWidth, 1);\n        const overlayH = overlayW * aspect;\n        const centerX = canvas.width / 2 + overlay.x;\n        const centerY = canvas.height / 2 + overlay.y;\n        ctx.save();\n        ctx.translate(centerX, centerY);\n        ctx.rotate(overlay.rotation * Math.PI / 180);\n        // non-uniform scale and shear to approximate warping\n        const sy = overlay.scaleY || 1;\n        const shy = overlay.shearY || 0; // shear on Y axis\n        const warp = overlay.warp || 0; // additional piecewise vertical scaling\n        ctx.transform(1, shy, 0, sy, 0, 0);\n        if (warp > 0) {\n          const slices = 24;\n          const srcH = overlayH;\n          for (let i = 0; i < slices; i++) {\n            const t0 = i / slices; // 0..1 top->bottom\n            const t1 = (i + 1) / slices;\n            const ty = (t0 + t1) / 2 - 0.5; // -0.5..0.5 center\n            const localScale = 1 + warp * (Math.abs(ty) * 2 - 0.5); // slightly more scale at chest/hip\n            const sh = srcH / slices * localScale;\n            const sy0 = -overlayH / 2 + t0 * overlayH;\n            const srcY = t0 * garment.height;\n            const srcSliceH = garment.height / slices;\n            ctx.drawImage(garment, 0, srcY, garment.width, srcSliceH, -overlayW / 2, sy0, overlayW, sh);\n          }\n        } else {\n          ctx.drawImage(garment, -overlayW / 2, -overlayH / 2, overlayW, overlayH);\n        }\n        // carve a small neck opening so collar doesn't overlay the neck\n        if (overlay.neckX != null && overlay.neckY != null && overlay.shoulderW) {\n          ctx.globalCompositeOperation = 'destination-out';\n          const neckLocalX = overlay.neckX - (canvas.width / 2 + overlay.x);\n          const neckLocalY = overlay.neckY - (canvas.height / 2 + overlay.y);\n          const rx = Math.max(6, overlay.shoulderW * 0.22);\n          const ry = Math.max(4, overlay.shoulderW * 0.16);\n          ctx.beginPath();\n          ctx.ellipse(neckLocalX, neckLocalY, rx, ry, 0, 0, Math.PI * 2);\n          ctx.fill();\n          ctx.globalCompositeOperation = 'source-over';\n        }\n        ctx.restore();\n      }\n\n      // Optional guides\n      if (showGuides) {\n        ctx.strokeStyle = 'rgba(0,0,0,0.2)';\n        ctx.beginPath();\n        ctx.moveTo(canvas.width / 2, 0);\n        ctx.lineTo(canvas.width / 2, canvas.height);\n        ctx.stroke();\n        ctx.beginPath();\n        ctx.moveTo(0, canvas.height / 2);\n        ctx.lineTo(canvas.width, canvas.height / 2);\n        ctx.stroke();\n      }\n\n      // 3) occlusion: draw person foreground on top using mask\n      if (enableOcclusion && segRef.current && (bgImage || mode === 'camera')) {\n        const seg = segRef.current;\n        let maskImg = null;\n        await new Promise(resolve => {\n          seg.onResults(res => {\n            maskImg = res.segmentationMask;\n            resolve();\n          });\n          seg.send({\n            image: frameCanvas\n          });\n        });\n        if (maskImg) {\n          const personCanvas = document.createElement('canvas');\n          personCanvas.width = canvas.width;\n          personCanvas.height = canvas.height;\n          const pc = personCanvas.getContext('2d');\n          // Grow the mask a bit and blur for softer edges around hands/arms\n          const maskCanvas = document.createElement('canvas');\n          maskCanvas.width = canvas.width;\n          maskCanvas.height = canvas.height;\n          const mc = maskCanvas.getContext('2d');\n          mc.drawImage(maskImg, 0, 0, canvas.width, canvas.height);\n          // If hands model is ready, paint convex hulls of hands onto the mask\n          if (handsRef.current) {\n            const hands = handsRef.current;\n            let handsData = null;\n            await new Promise(resolve => {\n              hands.onResults(res => {\n                handsData = res.multiHandLandmarks || [];\n                resolve();\n              });\n              hands.send({\n                image: frameCanvas\n              });\n            });\n            if (handsData && handsData.length) {\n              mc.fillStyle = '#fff';\n              mc.globalAlpha = 1.0;\n              handsData.forEach(points => {\n                if (!points || points.length === 0) return;\n                mc.beginPath();\n                const scaleX = canvas.width,\n                  scaleY = canvas.height;\n                points.forEach((p, i) => {\n                  const x = p.x * scaleX,\n                    y = p.y * scaleY;\n                  if (i === 0) mc.moveTo(x, y);else mc.lineTo(x, y);\n                });\n                mc.closePath();\n                mc.fill();\n              });\n            }\n          }\n          // simple dilation by drawing shifted copies\n          const expanded = document.createElement('canvas');\n          expanded.width = canvas.width;\n          expanded.height = canvas.height;\n          const ex = expanded.getContext('2d');\n          for (const [dx, dy] of [[0, 0], [1, 0], [-1, 0], [0, 1], [0, -1], [1, 1], [-1, 1], [1, -1], [-1, -1]]) {\n            ex.drawImage(maskCanvas, dx, dy);\n          }\n          ex.filter = 'blur(2px)';\n          ex.drawImage(expanded, 0, 0);\n          pc.drawImage(frameCanvas, 0, 0);\n          pc.globalCompositeOperation = 'destination-in';\n          pc.drawImage(expanded, 0, 0);\n          pc.globalCompositeOperation = 'source-over';\n          ctx.drawImage(personCanvas, 0, 0);\n        }\n      }\n    };\n    const loop = () => {\n      if (mode === 'camera') {\n        draw();\n        rafRef.current = requestAnimationFrame(loop);\n      } else {\n        draw();\n      }\n    };\n    loop();\n    return () => {\n      if (rafRef.current) cancelAnimationFrame(rafRef.current);\n    };\n  }, [bgImage, mode, overlay, canvasSize.width, canvasSize.height, enableOcclusion, autoRemoveBg, showGuides]);\n\n  // Live refresh in camera mode\n  useEffect(() => {\n    if (mode !== \"camera\") return;\n    const id = setInterval(() => {\n      const canvas = canvasRef.current;\n      const ctx = canvas === null || canvas === void 0 ? void 0 : canvas.getContext(\"2d\");\n      if (!canvas || !ctx) return;\n      // redraw\n      const productImg = productImgRef.current;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      if (videoRef.current) {\n        ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        if (productImg) {\n          const baseSize = Math.min(canvas.width, canvas.height) * 0.6;\n          const overlayW = baseSize * overlay.scale;\n          const overlayH = overlayW * (productImg.naturalHeight / Math.max(productImg.naturalWidth, 1));\n          const centerX = canvas.width / 2 + overlay.x;\n          const centerY = canvas.height / 2 + overlay.y;\n          ctx.save();\n          ctx.translate(centerX, centerY);\n          ctx.rotate(overlay.rotation * Math.PI / 180);\n          ctx.drawImage(productImg, -overlayW / 2, -overlayH / 2, overlayW, overlayH);\n          ctx.restore();\n        }\n      }\n    }, 100);\n    return () => clearInterval(id);\n  }, [mode, overlay]);\n  const downloadImage = () => {\n    try {\n      const link = document.createElement(\"a\");\n      link.download = `${productName || \"product\"}-tryon.png`;\n      link.href = canvasRef.current.toDataURL(\"image/png\");\n      link.click();\n    } catch (err) {\n      console.error(\"Download failed:\", err);\n      alert(\"Download failed. If product images come from a different domain, enable CORS or use same-origin images.\");\n    }\n  };\n  const handleAddToCart = () => {\n    if (!onAddToCart) return;\n    if (isLoggedIn) onAddToCart();else alert(\"Please login to add items to cart.\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"vto\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Virtual Try-On\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vto-mode\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: mode === \"upload\" ? \"active\" : \"\",\n        onClick: () => setMode(\"upload\"),\n        children: \"Upload Photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: mode === \"camera\" ? \"active\" : \"\",\n        onClick: () => setMode(\"camera\"),\n        children: \"Use Camera\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 495,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vto-stage\",\n      children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: canvasSize.width,\n        height: canvasSize.height,\n        className: \"vto-canvas\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: productImgRef,\n        src: productImage,\n        alt: productName,\n        crossOrigin: \"anonymous\",\n        style: {\n          display: \"none\"\n        },\n        onLoad: () => {\n          prepareGarmentBitmap();\n          setOverlay(o => ({\n            ...o\n          }));\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 9\n      }, this), productMaskImage ? /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: maskImgRef,\n        src: productMaskImage,\n        alt: \"mask\",\n        crossOrigin: \"anonymous\",\n        style: {\n          display: \"none\"\n        },\n        onLoad: () => {\n          prepareGarmentBitmap();\n          setOverlay(o => ({\n            ...o\n          }));\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 7\n    }, this), mode === \"upload\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vto-upload\",\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: onFileChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 528,\n      columnNumber: 9\n    }, this), mode === \"camera\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vto-camera\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        className: \"vto-video\",\n        playsInline: true,\n        muted: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 535,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: captureFromCamera,\n        children: \"Capture Photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 536,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 534,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vto-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Position X\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: -canvasSize.width / 2,\n          max: canvasSize.width / 2,\n          value: overlay.x,\n          onChange: e => setOverlay({\n            ...overlay,\n            x: Number(e.target.value)\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Position Y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: -canvasSize.height / 2,\n          max: canvasSize.height / 2,\n          value: overlay.y,\n          onChange: e => setOverlay({\n            ...overlay,\n            y: Number(e.target.value)\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Scale\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: 0.2,\n          max: 2,\n          step: 0.01,\n          value: overlay.scale,\n          onChange: e => setOverlay({\n            ...overlay,\n            scale: Number(e.target.value)\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 551,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 549,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Stretch Y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: 0.6,\n          max: 1.8,\n          step: 0.01,\n          value: overlay.scaleY,\n          onChange: e => setOverlay({\n            ...overlay,\n            scaleY: Number(e.target.value)\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Warp\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: 0,\n          max: 0.4,\n          step: 0.005,\n          value: overlay.warp,\n          onChange: e => setOverlay({\n            ...overlay,\n            warp: Number(e.target.value)\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 557,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Rotation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: -180,\n          max: 180,\n          value: overlay.rotation,\n          onChange: e => setOverlay({\n            ...overlay,\n            rotation: Number(e.target.value)\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !poseReady,\n          onClick: autoFit,\n          children: \"Auto Fit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            disabled: !segReady,\n            checked: enableOcclusion && segReady,\n            onChange: e => setEnableOcclusion(e.target.checked)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 570,\n            columnNumber: 13\n          }, this), \"Occlusion \", segReady ? '' : '(loading...)']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 568,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: autoRemoveBg,\n            onChange: e => setAutoRemoveBg(e.target.checked)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 575,\n            columnNumber: 18\n          }, this), \" Remove garment bg\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: showGuides,\n            onChange: e => setShowGuides(e.target.checked)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 18\n          }, this), \" Show guides\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ctrl\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"User height (cm)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 581,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          value: userHeightCm,\n          onChange: e => setUserHeightCm(Number(e.target.value) || 170),\n          style: {\n            width: 100\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 580,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vto-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: downloadImage,\n        children: \"Download Result\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 587,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn primary\",\n        onClick: handleAddToCart,\n        children: \"Add To Cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 588,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 492,\n    columnNumber: 5\n  }, this);\n};\n_s(VirtualTryOn, \"c8MjAbRdfpb2T96WiYekcyhZq8A=\");\n_c = VirtualTryOn;\nexport default VirtualTryOn;\nvar _c;\n$RefreshReg$(_c, \"VirtualTryOn\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","constraints","video","width","height","audio","VirtualTryOn","productImage","productMaskImage","productName","onAddToCart","isLoggedIn","_s","mode","setMode","bgImage","setBgImage","overlay","setOverlay","scale","scaleY","shearY","warp","rotation","x","y","neckX","neckY","shoulderW","canvasSize","setCanvasSize","poseReady","setPoseReady","segReady","setSegReady","handsReady","setHandsReady","enableOcclusion","setEnableOcclusion","autoRemoveBg","setAutoRemoveBg","showGuides","setShowGuides","userHeightCm","setUserHeightCm","videoRef","streamRef","canvasRef","productImgRef","maskImgRef","garmentCanvasRef","poseRef","segRef","handsRef","rafRef","prepareGarmentBitmap","img","current","naturalWidth","w","h","naturalHeight","gc","document","createElement","gctx","getContext","drawImage","maskImg","globalCompositeOperation","imgData","getImageData","d","data","sample","i","corners","avg","reduce","a","c","map","v","dist","r","g","b","Math","hypot","T","length","nearBg","aCopy","Uint8ClampedArray","idx","hole","min","putImageData","e","autoFit","canvas","ctx","drawW","drawH","offsetX","offsetY","alert","p","landmarks","Promise","resolve","onResults","res","poseLandmarks","send","image","L","ls","rs","le","re","ex1","ey1","ex2","ey2","earW","midx","midy","sx","sy","rx","ry","mx","my","max","base","desiredOverlayW","angleDeg","atan2","PI","torsoLen","lh","rh","hx","hy","shoulderDy","cx","cy","nose","noseY","targetY","yOffset","o","round","startCamera","stream","navigator","mediaDevices","getUserMedia","srcObject","play","err","console","error","stopCamera","getTracks","forEach","t","stop","window","Pose","pose","s","src","async","onload","locateFile","file","setOptions","modelComplexity","selfieMode","smoothLandmarks","enableSegmentation","body","appendChild","Hands","hands","maxNumHands","minDetectionConfidence","minTrackingConfidence","SelfieSegmentation","selfieSegmentation","SS","seg","modelSelection","onFileChange","_e$target$files","target","files","reader","FileReader","Image","maxW","maxH","ratio","result","readAsDataURL","captureFromCamera","videoWidth","videoHeight","temp","toDataURL","draw","clearRect","frameCanvas","fctx","paused","fillStyle","fillRect","productImg","garment","baseSize","overlayW","aspect","overlayH","centerX","centerY","save","translate","rotate","shy","transform","slices","srcH","t0","t1","ty","localScale","abs","sh","sy0","srcY","srcSliceH","neckLocalX","neckLocalY","beginPath","ellipse","fill","restore","strokeStyle","moveTo","lineTo","stroke","segmentationMask","personCanvas","pc","maskCanvas","mc","handsData","multiHandLandmarks","globalAlpha","points","scaleX","closePath","expanded","ex","dx","dy","filter","loop","requestAnimationFrame","cancelAnimationFrame","id","setInterval","clearInterval","downloadImage","link","download","href","click","handleAddToCart","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","alt","crossOrigin","style","display","onLoad","type","accept","onChange","playsInline","muted","value","Number","step","disabled","checked","_c","$RefreshReg$"],"sources":["D:/ec/E_Commerence/frontend/src/Components/VirtualTryOn/VirtualTryOn.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport \"./VirtualTryOn.css\";\n\n/*\n  VirtualTryOn component\n  - User can upload a photo or use camera\n  - Product image is overlaid on top with controls (move/scale/rotate)\n  - Download the composed image\n  - Reuses parent add-to-cart logic via onAddToCart prop\n*/\n\nconst constraints = { video: { width: 640, height: 480 }, audio: false };\n\nexport const VirtualTryOn = ({ productImage, productMaskImage, productName, onAddToCart, isLoggedIn }) => {\n  const [mode, setMode] = useState(\"upload\"); // 'upload' | 'camera'\n  const [bgImage, setBgImage] = useState(null); // Image element for user's photo\n  const [overlay, setOverlay] = useState({ scale: 1, scaleY: 1, shearY: 0, warp: 0.15, rotation: 0, x: 0, y: 0, neckX: null, neckY: null, shoulderW: null });\n  const [canvasSize, setCanvasSize] = useState({ width: 640, height: 480 });\n  const [poseReady, setPoseReady] = useState(false);\n  const [segReady, setSegReady] = useState(false);\n  const [handsReady, setHandsReady] = useState(false);\n  const [enableOcclusion, setEnableOcclusion] = useState(true);\n  const [autoRemoveBg, setAutoRemoveBg] = useState(true);\n  const [showGuides, setShowGuides] = useState(false);\n  const [userHeightCm, setUserHeightCm] = useState(170);\n\n  const videoRef = useRef(null);\n  const streamRef = useRef(null);\n  const canvasRef = useRef(null);\n  const productImgRef = useRef(null);\n  const maskImgRef = useRef(null);\n  const garmentCanvasRef = useRef(null); // cached masked garment\n  const poseRef = useRef(null);\n  const segRef = useRef(null);\n  const handsRef = useRef(null);\n  const rafRef = useRef(null);\n\n  // Build masked garment canvas from product image and optional mask\n  const prepareGarmentBitmap = () => {\n    try {\n      const img = productImgRef.current;\n      if (!img || !img.naturalWidth) return;\n      const w = img.naturalWidth, h = img.naturalHeight;\n      const gc = document.createElement('canvas');\n      gc.width = w; gc.height = h;\n      const gctx = gc.getContext('2d');\n      gctx.drawImage(img, 0, 0);\n\n      // If we have a precomputed mask image, apply it\n      const maskImg = maskImgRef.current;\n      if (maskImg && maskImg.naturalWidth) {\n        gctx.globalCompositeOperation = 'destination-in';\n        gctx.drawImage(maskImg, 0, 0, w, h);\n        gctx.globalCompositeOperation = 'source-over';\n        garmentCanvasRef.current = gc;\n        return;\n      }\n\n      // Auto-generate mask by sampling corner background and thresholding\n      const imgData = gctx.getImageData(0, 0, w, h);\n      const d = imgData.data;\n      const sample = (x, y) => { const i = (y * w + x) * 4; return [d[i], d[i+1], d[i+2]]; };\n      const corners = [ sample(2, 2), sample(w-3, 2), sample(2, h-3), sample(w-3, h-3) ];\n      const avg = corners.reduce((a,c)=>[a[0]+c[0],a[1]+c[1],a[2]+c[2]],[0,0,0]).map(v=>v/4);\n      const dist = (r,g,b)=> Math.hypot(r-avg[0], g-avg[1], b-avg[2]);\n      const T = 40;\n      for (let i=0;i<d.length;i+=4){\n        const r=d[i], g=d[i+1], b=d[i+2];\n        const nearBg = dist(r,g,b) < T || (r>240&&g>240&&b>240);\n        if (nearBg) d[i+3] = 0;\n      }\n      const aCopy = new Uint8ClampedArray(d);\n      const idx = (x,y)=> (y*w+x)*4 + 3;\n      for (let y=1;y<h-1;y++){\n        for (let x=1;x<w-1;x++){\n          const a = aCopy[idx(x,y)];\n          if (a===0) continue;\n          let hole = 0;\n          if (aCopy[idx(x-1,y)]===0) hole++;\n          if (aCopy[idx(x+1,y)]===0) hole++;\n          if (aCopy[idx(x,y-1)]===0) hole++;\n          if (aCopy[idx(x,y+1)]===0) hole++;\n          if (hole>0) d[idx(x,y)] = Math.min(200, a);\n        }\n      }\n      gctx.putImageData(imgData,0,0);\n      garmentCanvasRef.current = gc;\n    } catch (e) {}\n  };\n\n  // Auto fit garment using pose landmarks\n  const autoFit = async () => {\n    try {\n      if (!poseRef.current) return;\n      const canvas = document.createElement(\"canvas\");\n      canvas.width = canvasSize.width; canvas.height = canvasSize.height;\n      const ctx = canvas.getContext(\"2d\");\n      if (bgImage) {\n        // draw with aspect preserved like render loop\n        const scale = Math.min(canvas.width / bgImage.width, canvas.height / bgImage.height);\n        const drawW = bgImage.width * scale;\n        const drawH = bgImage.height * scale;\n        const offsetX = (canvas.width - drawW) / 2;\n        const offsetY = (canvas.height - drawH) / 2;\n        ctx.drawImage(bgImage, offsetX, offsetY, drawW, drawH);\n      } else if (mode === \"camera\" && videoRef.current) {\n        ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n      } else {\n        alert('No image available to detect. Upload or capture a photo.');\n        return;\n      }\n      const p = poseRef.current;\n      let landmarks = null;\n      await new Promise((resolve) => {\n        p.onResults((res) => { landmarks = res.poseLandmarks; resolve(); });\n        p.send({ image: canvas });\n      });\n      if (!landmarks || landmarks.length < 25) { alert('Could not detect body landmarks. Try another photo facing camera.'); return; }\n      const L = landmarks;\n      const w = canvas.width, h = canvas.height;\n      let ls = L[11], rs = L[12];\n      // Fallback: estimate shoulders from ears if needed\n      if ((!ls || !rs) && L[7] && L[8]) {\n        const le = L[7], re = L[8];\n        const ex1 = (le.x||0)*w, ey1=(le.y||0)*h;\n        const ex2 = (re.x||0)*w, ey2=(re.y||0)*h;\n        const earW = Math.hypot(ex1-ex2, ey1-ey2);\n        const midx = (ex1+ex2)/2, midy=(ey1+ey2)/2 + earW*0.9; // move down from ears to approx shoulders\n        ls = { x:(midx-earW*0.9)/w, y: midy/h };\n        rs = { x:(midx+earW*0.9)/w, y: midy/h };\n      }\n      if (!ls || !rs) { alert('Shoulders not found. Ensure your shoulders are visible.'); return; }\n      const sx = (ls.x || 0) * w, sy = (ls.y || 0) * h;\n      const rx = (rs.x || 0) * w, ry = (rs.y || 0) * h;\n      const mx = (sx + rx) / 2, my = (sy + ry) / 2;\n      const shoulderW = Math.max(10, Math.hypot(sx - rx, sy - ry));\n      const base = Math.min(w, h) * 0.6;\n      const desiredOverlayW = shoulderW * 1.8;\n      const scale = Math.max(0.3, Math.min(1.8, desiredOverlayW / Math.max(base, 1)));\n      const angleDeg = (Math.atan2(ry - sy, rx - sx) * 180) / Math.PI;\n      let torsoLen = shoulderW * 1.2;\n      const lh = L[23], rh = L[24];\n      if (lh && rh) {\n        const hx = ((lh.x||0)+(rh.x||0))/2 * w;\n        const hy = ((lh.y||0)+(rh.y||0))/2 * h;\n        torsoLen = Math.max(shoulderW*0.8, Math.hypot(mx - hx, my - hy));\n      }\n      const scaleY = Math.max(0.8, Math.min(1.6, torsoLen / Math.max(shoulderW,1)));\n      // shearY based on shoulder vertical difference before rotation\n      const shoulderDy = (ry - sy);\n      const shearY = Math.max(-0.3, Math.min(0.3, (shoulderDy / Math.max(shoulderW, 1)) * 0.8));\n      const cx = w / 2, cy = h / 2;\n      // Estimate neck Y using nose and ears\n      const nose = L[0];\n      let neckY = my; // fallback: shoulder mid\n      if (nose) {\n        const noseY = (nose.y||0)*h;\n        neckY = Math.min(my - shoulderW*0.15, noseY + shoulderW*0.35);\n      }\n      // convert neck target to overlay offset relative to canvas center\n      const targetY = neckY;\n      // place garment so collar sits near neck target (heuristic offset)\n      const yOffset = (my - targetY) + shoulderW * 0.5;\n      setOverlay((o) => ({ ...o, x: Math.round(mx - cx), y: Math.round(my - cy - yOffset), scale, scaleY, shearY, rotation: Math.round(angleDeg), neckX: mx, neckY: neckY, shoulderW }));\n    } catch (e) {}\n  };\n\n  // Camera handling\n  useEffect(() => {\n    const startCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(constraints);\n        streamRef.current = stream;\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n        setCanvasSize({ width: constraints.video.width, height: constraints.video.height });\n      } catch (err) {\n        console.error(\"Camera error:\", err);\n        alert(\"Unable to access camera. Please allow permission or use Upload mode.\");\n        setMode(\"upload\");\n      }\n    };\n    const stopCamera = () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach((t) => t.stop());\n        streamRef.current = null;\n      }\n    };\n    if (mode === \"camera\") startCamera(); else stopCamera();\n    return () => stopCamera();\n  }, [mode]);\n\n  useEffect(() => {\n    if (window.Pose || window.pose) return;\n    const s = document.createElement(\"script\");\n    s.src = \"https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js\";\n    s.async = true;\n    s.onload = () => {\n      try {\n        const Pose = window.Pose || window.pose;\n        if (!Pose || !Pose.Pose) return;\n        const p = new Pose.Pose({ locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}` });\n        p.setOptions({ modelComplexity: 0, selfieMode: true, smoothLandmarks: true, enableSegmentation: false });\n        poseRef.current = p;\n        setPoseReady(true);\n      } catch (e) {}\n    };\n    document.body.appendChild(s);\n  }, []);\n\n  // Load MediaPipe Hands to reinforce occlusion for hands/arms\n  useEffect(() => {\n    if (window.Hands || window.hands) return;\n    const s = document.createElement('script');\n    s.src = 'https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js';\n    s.async = true;\n    s.onload = () => {\n      try{\n        const Hands = window.Hands || window.hands;\n        if(!Hands || !Hands.Hands) return;\n        const h = new Hands.Hands({ locateFile: (file)=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}` });\n        h.setOptions({ selfieMode: true, maxNumHands: 2, modelComplexity: 1, minDetectionConfidence: 0.5, minTrackingConfidence: 0.5 });\n        handsRef.current = h;\n        setHandsReady(true);\n      }catch(e){}\n    };\n    document.body.appendChild(s);\n  }, []);\n\n  useEffect(() => {\n    if (window.SelfieSegmentation || window.selfieSegmentation) return;\n    const s = document.createElement(\"script\");\n    s.src = \"https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js\";\n    s.async = true;\n    s.onload = () => {\n      try {\n        const SS = window.SelfieSegmentation || window.selfieSegmentation;\n        if (!SS || !SS.SelfieSegmentation) return;\n        const seg = new SS.SelfieSegmentation({ locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${file}` });\n        seg.setOptions({ modelSelection: 1 }); // landscape general\n        segRef.current = seg;\n        setSegReady(true);\n        setEnableOcclusion(true);\n      } catch (e) {}\n    };\n    document.body.appendChild(s);\n  }, []);\n\n  // File upload -> load as Image\n  const onFileChange = (e) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      const img = new Image();\n      img.onload = () => {\n        setBgImage(img);\n        const maxW = 800, maxH = 800;\n        let w = img.width, h = img.height;\n        const ratio = Math.min(maxW / w, maxH / h, 1);\n        setCanvasSize({ width: Math.round(w * ratio), height: Math.round(h * ratio) });\n      };\n      img.src = reader.result;\n    };\n    reader.readAsDataURL(file);\n  };\n\n  // Capture from camera\n  const captureFromCamera = () => {\n    if (!videoRef.current) return;\n    const { videoWidth: w, videoHeight: h } = videoRef.current;\n    setCanvasSize({ width: w, height: h });\n    const temp = document.createElement(\"canvas\");\n    temp.width = w; temp.height = h;\n    const ctx = temp.getContext(\"2d\");\n    ctx.drawImage(videoRef.current, 0, 0, w, h);\n    const img = new Image();\n    img.onload = () => setBgImage(img);\n    img.src = temp.toDataURL(\"image/png\");\n  };\n\n  // Draw composition with rAF and optional occlusion\n  useEffect(() => {\n    const { width, height } = canvasSize; // for lint dependency clarity\n    const draw = async () => {\n      const canvas = canvasRef.current;\n      const ctx = canvas?.getContext(\"2d\");\n      if (!canvas || !ctx) return;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      // 1) capture background frame\n      let frameCanvas = document.createElement(\"canvas\");\n      frameCanvas.width = canvas.width; frameCanvas.height = canvas.height;\n      const fctx = frameCanvas.getContext(\"2d\");\n      if (bgImage) {\n        const scale = Math.min(canvas.width / bgImage.width, canvas.height / bgImage.height);\n        const drawW = bgImage.width * scale;\n        const drawH = bgImage.height * scale;\n        const offsetX = (canvas.width - drawW) / 2;\n        const offsetY = (canvas.height - drawH) / 2;\n        fctx.drawImage(bgImage, offsetX, offsetY, drawW, drawH);\n        ctx.drawImage(frameCanvas, 0, 0);\n      } else if (mode === \"camera\" && videoRef.current && !videoRef.current.paused) {\n        fctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        ctx.drawImage(frameCanvas, 0, 0);\n      } else {\n        ctx.fillStyle = \"#f5f5f5\";\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n      }\n\n      // 2) draw garment overlay (use prepared garment canvas)\n      const productImg = productImgRef.current;\n      if (productImg) {\n        let garment = garmentCanvasRef.current || productImg;\n\n        const baseSize = Math.min(canvas.width, canvas.height) * 0.6;\n        const overlayW = baseSize * (overlay.scale || 1);\n        const aspect = (garment.height || productImg.naturalHeight) / Math.max((garment.width || productImg.naturalWidth),1);\n        const overlayH = overlayW * aspect;\n        const centerX = canvas.width / 2 + overlay.x;\n        const centerY = canvas.height / 2 + overlay.y;\n\n        ctx.save();\n        ctx.translate(centerX, centerY);\n        ctx.rotate((overlay.rotation * Math.PI) / 180);\n        // non-uniform scale and shear to approximate warping\n        const sy = overlay.scaleY || 1;\n        const shy = overlay.shearY || 0; // shear on Y axis\n        const warp = overlay.warp || 0;  // additional piecewise vertical scaling\n        ctx.transform(1, shy, 0, sy, 0, 0);\n        if (warp > 0) {\n          const slices = 24;\n          const srcH = overlayH;\n          for (let i=0;i<slices;i++){\n            const t0 = i / slices;            // 0..1 top->bottom\n            const t1 = (i+1) / slices;\n            const ty = (t0 + t1)/2 - 0.5;     // -0.5..0.5 center\n            const localScale = 1 + warp * (Math.abs(ty)*2 - 0.5); // slightly more scale at chest/hip\n            const sh = (srcH / slices) * localScale;\n            const sy0 = -overlayH/2 + t0*overlayH;\n            const srcY = (t0) * garment.height;\n            const srcSliceH = garment.height / slices;\n            ctx.drawImage(\n              garment,\n              0, srcY, garment.width, srcSliceH,\n              -overlayW/2, sy0, overlayW, sh\n            );\n          }\n        } else {\n          ctx.drawImage(garment, -overlayW / 2, -overlayH / 2, overlayW, overlayH);\n        }\n        // carve a small neck opening so collar doesn't overlay the neck\n        if (overlay.neckX != null && overlay.neckY != null && overlay.shoulderW){\n          ctx.globalCompositeOperation = 'destination-out';\n          const neckLocalX = overlay.neckX - (canvas.width/2 + overlay.x);\n          const neckLocalY = overlay.neckY - (canvas.height/2 + overlay.y);\n          const rx = Math.max(6, overlay.shoulderW*0.22);\n          const ry = Math.max(4, overlay.shoulderW*0.16);\n          ctx.beginPath();\n          ctx.ellipse(neckLocalX, neckLocalY, rx, ry, 0, 0, Math.PI*2);\n          ctx.fill();\n          ctx.globalCompositeOperation = 'source-over';\n        }\n        ctx.restore();\n      }\n\n      // Optional guides\n      if (showGuides) {\n        ctx.strokeStyle = 'rgba(0,0,0,0.2)';\n        ctx.beginPath(); ctx.moveTo(canvas.width/2,0); ctx.lineTo(canvas.width/2,canvas.height); ctx.stroke();\n        ctx.beginPath(); ctx.moveTo(0,canvas.height/2); ctx.lineTo(canvas.width,canvas.height/2); ctx.stroke();\n      }\n\n      // 3) occlusion: draw person foreground on top using mask\n      if (enableOcclusion && segRef.current && (bgImage || mode==='camera')){\n        const seg = segRef.current;\n        let maskImg = null;\n        await new Promise((resolve)=>{\n          seg.onResults((res)=>{ maskImg = res.segmentationMask; resolve(); });\n          seg.send({ image: frameCanvas });\n        });\n        if (maskImg){\n          const personCanvas = document.createElement('canvas');\n          personCanvas.width = canvas.width; personCanvas.height = canvas.height;\n          const pc = personCanvas.getContext('2d');\n          // Grow the mask a bit and blur for softer edges around hands/arms\n          const maskCanvas = document.createElement('canvas');\n          maskCanvas.width = canvas.width; maskCanvas.height = canvas.height;\n          const mc = maskCanvas.getContext('2d');\n          mc.drawImage(maskImg,0,0,canvas.width,canvas.height);\n          // If hands model is ready, paint convex hulls of hands onto the mask\n          if (handsRef.current) {\n            const hands = handsRef.current;\n            let handsData = null;\n            await new Promise((resolve)=>{\n              hands.onResults((res)=>{ handsData = res.multiHandLandmarks || []; resolve(); });\n              hands.send({ image: frameCanvas });\n            });\n            if (handsData && handsData.length) {\n              mc.fillStyle = '#fff';\n              mc.globalAlpha = 1.0;\n              handsData.forEach(points=>{\n                if (!points || points.length===0) return;\n                mc.beginPath();\n                const scaleX = canvas.width, scaleY = canvas.height;\n                points.forEach((p,i)=>{ const x=p.x*scaleX, y=p.y*scaleY; if(i===0) mc.moveTo(x,y); else mc.lineTo(x,y); });\n                mc.closePath();\n                mc.fill();\n              });\n            }\n          }\n          // simple dilation by drawing shifted copies\n          const expanded = document.createElement('canvas');\n          expanded.width = canvas.width; expanded.height = canvas.height;\n          const ex = expanded.getContext('2d');\n          for (const [dx,dy] of [[0,0],[1,0],[-1,0],[0,1],[0,-1],[1,1],[-1,1],[1,-1],[-1,-1]]){\n            ex.drawImage(maskCanvas, dx, dy);\n          }\n          ex.filter = 'blur(2px)';\n          ex.drawImage(expanded,0,0);\n          pc.drawImage(frameCanvas,0,0);\n          pc.globalCompositeOperation='destination-in';\n          pc.drawImage(expanded,0,0);\n          pc.globalCompositeOperation='source-over';\n          ctx.drawImage(personCanvas,0,0);\n        }\n      }\n    };\n\n    const loop = () => {\n      if (mode === 'camera') {\n        draw();\n        rafRef.current = requestAnimationFrame(loop);\n      } else {\n        draw();\n      }\n    };\n    loop();\n    return () => { if (rafRef.current) cancelAnimationFrame(rafRef.current); };\n  }, [bgImage, mode, overlay, canvasSize.width, canvasSize.height, enableOcclusion, autoRemoveBg, showGuides]);\n\n  // Live refresh in camera mode\n  useEffect(() => {\n    if (mode !== \"camera\") return;\n    const id = setInterval(() => {\n      const canvas = canvasRef.current;\n      const ctx = canvas?.getContext(\"2d\");\n      if (!canvas || !ctx) return;\n      // redraw\n      const productImg = productImgRef.current;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      if (videoRef.current) {\n        ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        if (productImg) {\n          const baseSize = Math.min(canvas.width, canvas.height) * 0.6;\n          const overlayW = baseSize * overlay.scale;\n          const overlayH = overlayW * (productImg.naturalHeight / Math.max(productImg.naturalWidth, 1));\n          const centerX = canvas.width / 2 + overlay.x;\n          const centerY = canvas.height / 2 + overlay.y;\n          ctx.save();\n          ctx.translate(centerX, centerY);\n          ctx.rotate((overlay.rotation * Math.PI) / 180);\n          ctx.drawImage(productImg, -overlayW / 2, -overlayH / 2, overlayW, overlayH);\n          ctx.restore();\n        }\n      }\n    }, 100);\n    return () => clearInterval(id);\n  }, [mode, overlay]);\n\n  const downloadImage = () => {\n    try {\n      const link = document.createElement(\"a\");\n      link.download = `${productName || \"product\"}-tryon.png`;\n      link.href = canvasRef.current.toDataURL(\"image/png\");\n      link.click();\n    } catch (err) {\n      console.error(\"Download failed:\", err);\n      alert(\"Download failed. If product images come from a different domain, enable CORS or use same-origin images.\");\n    }\n  };\n\n  const handleAddToCart = () => {\n    if (!onAddToCart) return;\n    if (isLoggedIn) onAddToCart();\n    else alert(\"Please login to add items to cart.\");\n  };\n\n  return (\n    <div className=\"vto\">\n      <h2>Virtual Try-On</h2>\n\n      <div className=\"vto-mode\">\n        <button className={mode === \"upload\" ? \"active\" : \"\"} onClick={() => setMode(\"upload\")}>\n          Upload Photo\n        </button>\n        <button className={mode === \"camera\" ? \"active\" : \"\"} onClick={() => setMode(\"camera\")}>\n          Use Camera\n        </button>\n      </div>\n\n      <div className=\"vto-stage\">\n        <canvas ref={canvasRef} width={canvasSize.width} height={canvasSize.height} className=\"vto-canvas\" />\n        <img\n          ref={productImgRef}\n          src={productImage}\n          alt={productName}\n          crossOrigin=\"anonymous\"\n          style={{ display: \"none\" }}\n          onLoad={() => { prepareGarmentBitmap(); setOverlay((o) => ({...o})) }}\n        />\n        {/* Optional precomputed mask for the product */}\n        {productMaskImage ? (\n          <img\n            ref={maskImgRef}\n            src={productMaskImage}\n            alt=\"mask\"\n            crossOrigin=\"anonymous\"\n            style={{ display: \"none\" }}\n            onLoad={() => { prepareGarmentBitmap(); setOverlay((o)=>({...o})) }}\n          />\n        ) : null}\n      </div>\n\n      {mode === \"upload\" && (\n        <div className=\"vto-upload\">\n          <input type=\"file\" accept=\"image/*\" onChange={onFileChange} />\n        </div>\n      )}\n\n      {mode === \"camera\" && (\n        <div className=\"vto-camera\">\n          <video ref={videoRef} className=\"vto-video\" playsInline muted />\n          <button onClick={captureFromCamera}>Capture Photo</button>\n        </div>\n      )}\n\n      <div className=\"vto-controls\">\n        <div className=\"ctrl\">\n          <label>Position X</label>\n          <input type=\"range\" min={-canvasSize.width/2} max={canvasSize.width/2} value={overlay.x} onChange={(e)=>setOverlay({...overlay, x:Number(e.target.value)})} />\n        </div>\n        <div className=\"ctrl\">\n          <label>Position Y</label>\n          <input type=\"range\" min={-canvasSize.height/2} max={canvasSize.height/2} value={overlay.y} onChange={(e)=>setOverlay({...overlay, y:Number(e.target.value)})} />\n        </div>\n        <div className=\"ctrl\">\n          <label>Scale</label>\n          <input type=\"range\" min={0.2} max={2} step={0.01} value={overlay.scale} onChange={(e)=>setOverlay({...overlay, scale:Number(e.target.value)})} />\n        </div>\n        <div className=\"ctrl\">\n          <label>Stretch Y</label>\n          <input type=\"range\" min={0.6} max={1.8} step={0.01} value={overlay.scaleY} onChange={(e)=>setOverlay({...overlay, scaleY:Number(e.target.value)})} />\n        </div>\n        <div className=\"ctrl\">\n          <label>Warp</label>\n          <input type=\"range\" min={0} max={0.4} step={0.005} value={overlay.warp} onChange={(e)=>setOverlay({...overlay, warp:Number(e.target.value)})} />\n        </div>\n        <div className=\"ctrl\">\n          <label>Rotation</label>\n          <input type=\"range\" min={-180} max={180} value={overlay.rotation} onChange={(e)=>setOverlay({...overlay, rotation:Number(e.target.value)})} />\n        </div>\n        <div className=\"ctrl\">\n          <button disabled={!poseReady} onClick={autoFit}>Auto Fit</button>\n        </div>\n        <div className=\"ctrl\">\n          <label>\n            <input type=\"checkbox\" disabled={!segReady} checked={enableOcclusion && segReady} onChange={(e)=>setEnableOcclusion(e.target.checked)} />\n            Occlusion {segReady ? '' : '(loading...)'}\n          </label>\n        </div>\n        <div className=\"ctrl\">\n          <label><input type=\"checkbox\" checked={autoRemoveBg} onChange={(e)=>setAutoRemoveBg(e.target.checked)} /> Remove garment bg</label>\n        </div>\n        <div className=\"ctrl\">\n          <label><input type=\"checkbox\" checked={showGuides} onChange={(e)=>setShowGuides(e.target.checked)} /> Show guides</label>\n        </div>\n        <div className=\"ctrl\">\n          <label>User height (cm)</label>\n          <input type=\"number\" value={userHeightCm} onChange={(e)=>setUserHeightCm(Number(e.target.value)||170)} style={{ width: 100 }} />\n        </div>\n      </div>\n\n      <div className=\"vto-actions\">\n        <button className=\"btn\" onClick={downloadImage}>Download Result</button>\n        <button className=\"btn primary\" onClick={handleAddToCart}>Add To Cart</button>\n      </div>\n    </div>\n  );\n};\n\nexport default VirtualTryOn;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}