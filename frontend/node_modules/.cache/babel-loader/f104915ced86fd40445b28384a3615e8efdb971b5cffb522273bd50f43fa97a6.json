{"ast":null,"code":"import _objectSpread from\"D:/ec/E_Commerence/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useEffect,useState}from\"react\";import all_product from'../Components/Assets/all_product';import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const getDefaultCart=()=>{let cart={};for(let index=0;index<300+1;index++){cart[index]=0;}return cart;};const ShopContextProvider=props=>{const[all_product,setAll_Product]=useState([]);const[cartItems,setCartItems]=useState(getDefaultCart());useEffect(()=>{const inferMaskUrl=url=>{if(!url)return undefined;const q=String(url).split('?')[0];const dot=q.lastIndexOf('.');if(dot===-1)return url+'_mask';return q.slice(0,dot)+'_mask'+q.slice(dot);};fetch('http://localhost:4000/allproducts').then(response=>response.json()).then(data=>{try{const enriched=Array.isArray(data)?data.map(p=>_objectSpread(_objectSpread({},p),{},{mask:p.mask||inferMaskUrl(p.image)})):data;setAll_Product(enriched);}catch(_unused){setAll_Product(data);}});if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/getcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:\"\"}).then(response=>response.json()).then(data=>setCartItems(data));}},[]);const addToCart=itemId=>{setCartItems(prev=>_objectSpread(_objectSpread({},prev),{},{[itemId]:prev[itemId]+1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/addtocart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const removeFromCart=itemId=>{setCartItems(prev=>_objectSpread(_objectSpread({},prev),{},{[itemId]:prev[itemId]-1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/removefromcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){let itemInfo=all_product.find(product=>product.id===Number(item));totalAmount+=itemInfo.new_price*cartItems[item];}}return totalAmount;};const getTotalCartItems=()=>{let totalItem=0;for(const item in cartItems){if(cartItems[item]>0){totalItem+=cartItems[item];}}return totalItem;};const contextValue={getTotalCartItems,getTotalCartAmount,all_product,cartItems,addToCart,removeFromCart};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;","map":{"version":3,"names":["React","createContext","useEffect","useState","all_product","jsx","_jsx","ShopContext","getDefaultCart","cart","index","ShopContextProvider","props","setAll_Product","cartItems","setCartItems","inferMaskUrl","url","undefined","q","String","split","dot","lastIndexOf","slice","fetch","then","response","json","data","enriched","Array","isArray","map","p","_objectSpread","mask","image","_unused","localStorage","getItem","method","headers","Accept","concat","body","addToCart","itemId","prev","JSON","stringify","console","log","removeFromCart","getTotalCartAmount","totalAmount","item","itemInfo","find","product","id","Number","new_price","getTotalCartItems","totalItem","contextValue","Provider","value","children"],"sources":["D:/ec/E_Commerence/frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React,{createContext, useEffect, useState} from \"react\";\r\nimport all_product from '../Components/Assets/all_product'\r\nexport const ShopContext=createContext(null);\r\n\r\nconst getDefaultCart=()=>{\r\n        let cart={};\r\n       for(let index=0;index<300+1;index++){\r\n            cart[index]=0;\r\n       }\r\n        return cart;\r\n    }\r\n\r\nconst ShopContextProvider=(props)=>{\r\n\r\n    const[all_product,setAll_Product]=useState([]);\r\n    \r\n    const [cartItems,setCartItems]=useState(getDefaultCart());\r\n\r\n    useEffect(()=>{\r\n        const inferMaskUrl = (url) => {\r\n            if (!url) return undefined;\r\n            const q = String(url).split('?')[0];\r\n            const dot = q.lastIndexOf('.');\r\n            if (dot === -1) return url + '_mask';\r\n            return q.slice(0, dot) + '_mask' + q.slice(dot);\r\n        };\r\n        fetch('http://localhost:4000/allproducts')\r\n        .then((response)=>response.json())\r\n        .then((data)=>{\r\n            try{\r\n                const enriched = Array.isArray(data) ? data.map(p=> ({ ...p, mask: p.mask || inferMaskUrl(p.image) })) : data;\r\n                setAll_Product(enriched);\r\n            } catch {\r\n                setAll_Product(data);\r\n            }\r\n        })\r\n\r\n        if(localStorage.getItem('auth-token')){\r\n            fetch('http://localhost:4000/getcart',{\r\n                method:'POST',\r\n                headers:{\r\n                    Accept:'application/form-data',\r\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\r\n                    'Content-Type':'application/json',\r\n                },\r\n                body:\"\",\r\n            }).then((response)=>response.json())\r\n            .then((data)=>setCartItems(data));\r\n        }\r\n    },[])\r\n    \r\n    const addToCart=(itemId)=>{\r\n        setCartItems((prev)=>({...prev,[itemId]:prev[itemId]+1}))\r\n        if(localStorage.getItem('auth-token')){\r\n            fetch('http://localhost:4000/addtocart',{\r\n                method:'POST',\r\n                headers:{\r\n                    Accept:'application/form-data',\r\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\r\n                    'Content-Type':'application/json',\r\n                },\r\n                body:JSON.stringify({\"itemId\":itemId}),\r\n            })\r\n            .then((response)=>response.json())\r\n            .then((data)=>console.log(data));\r\n        }\r\n    }\r\n\r\n\r\n\r\n    const removeFromCart=(itemId)=>{\r\n        setCartItems((prev)=>({...prev,[itemId]:prev[itemId]-1}))\r\n        if(localStorage.getItem('auth-token')){\r\n             fetch('http://localhost:4000/removefromcart',{\r\n                method:'POST',\r\n                headers:{\r\n                    Accept:'application/form-data',\r\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\r\n                    'Content-Type':'application/json',\r\n                },\r\n                body:JSON.stringify({\"itemId\":itemId}),\r\n            })\r\n            .then((response)=>response.json())\r\n            .then((data)=>console.log(data));\r\n        }\r\n    }\r\n    const getTotalCartAmount=()=>{\r\n        let totalAmount=0;\r\n        for(const item in cartItems)\r\n        {\r\n            if(cartItems[item]>0)\r\n            {\r\n                let itemInfo=all_product.find((product)=>product.id===Number(item));\r\n                totalAmount+=itemInfo.new_price*cartItems[item];\r\n            }\r\n        }\r\n        return totalAmount;\r\n    }\r\n\r\n    const getTotalCartItems=()=>{\r\n        let totalItem=0;\r\n        for(const item in cartItems)\r\n        {\r\n            if(cartItems[item]>0)\r\n            {\r\n                totalItem+=cartItems[item];\r\n            }\r\n        }\r\n        return totalItem;\r\n    }\r\n    \r\n    const contextValue={ getTotalCartItems,getTotalCartAmount,all_product,cartItems,addToCart,removeFromCart};\r\n    \r\n    return(\r\n        <ShopContext.Provider value={contextValue}>\r\n            {props.children}\r\n        </ShopContext.Provider>\r\n    )\r\n}\r\nexport default ShopContextProvider;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}