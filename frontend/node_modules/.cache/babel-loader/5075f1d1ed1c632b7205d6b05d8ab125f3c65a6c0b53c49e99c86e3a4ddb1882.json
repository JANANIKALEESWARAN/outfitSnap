{"ast":null,"code":"var _jsxFileName = \"D:\\\\ec\\\\E_Commerence\\\\frontend\\\\src\\\\Components\\\\Chatbot\\\\Chatbot.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useMemo, useRef, useState } from 'react';\nimport './Chatbot.css';\nimport { ShopContext } from '../../Context/ShopContext';\nimport { Link } from 'react-router-dom';\nimport { WishlistContext } from '../../Context/WishlistContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst systemPrompts = ['Ask me about products, categories, prices, or style tips. Try: \"Show women t-shirts under $30\" or \"What is this site about?\"'];\nconst normalize = s => String(s || '').toLowerCase();\nconst STOPWORDS = new Set(['show', 'me', 'the', 'a', 'an', 'to', 'and', 'or', 'for', 'with', 'please', 'site', 'website', 'this', 'is', 'about', 'under', 'below', 'between', 'than', 'less', 'more', 'of', 'at', 'in', 'some', 'any', 'do', 'you', 'have']);\nconst SYNONYMS = new Map([['tshirt', 't-shirt'], ['tshirts', 't-shirt'], ['tee', 't-shirt'], ['hoodies', 'hoodie'], ['hoodie', 'hoodie'], ['shoe', 'shoes'], ['sneaker', 'shoes'], ['sneakers', 'shoes'], ['sandal', 'shoes'], ['sandals', 'shoes'], ['trainer', 'shoes'], ['trainers', 'shoes'], ['jeans', 'jeans'], ['denim', 'jeans'], ['trouser', 'pants'], ['trousers', 'pants'], ['pant', 'pants'], ['pants', 'pants'], ['shirt', 'shirt'], ['shirts', 'shirt'], ['top', 'top'], ['tops', 'top'], ['dress', 'dress'], ['dresses', 'dress'], ['skirt', 'skirt'], ['skirts', 'skirt'], ['jacket', 'jacket'], ['jackets', 'jacket'], ['women', 'women'], ['womens', 'women'], [\"women's\", 'women'], ['men', 'men'], ['mens', 'men'], [\"men's\", 'men'], ['kid', 'kid'], ['kids', 'kid']]);\nconst CATEGORY_TERMS = ['men', 'women', 'kid'];\nfunction editDistance(a, b) {\n  a = a || '';\n  b = b || '';\n  const dp = Array(b.length + 1).fill(0).map((_, i) => [i]);\n  for (let j = 0; j <= a.length; j++) {\n    dp[0][j] = j;\n  }\n  for (let i = 1; i <= b.length; i++) {\n    for (let j = 1; j <= a.length; j++) {\n      dp[i][j] = Math.min(dp[i - 1][j] + 1, dp[i][j - 1] + 1, dp[i - 1][j - 1] + (a[j - 1] === b[i - 1] ? 0 : 1));\n    }\n  }\n  return dp[b.length][a.length];\n}\nfunction bestCategory(tokens) {\n  let best = null,\n    bestScore = Infinity;\n  for (const t of tokens) {\n    for (const cat of CATEGORY_TERMS) {\n      const d = editDistance(t, cat);\n      if (d < bestScore) {\n        bestScore = d;\n        best = cat;\n      }\n    }\n  }\n  return bestScore <= 2 ? best : null; // tolerate small typos\n}\nfunction tokenize(q) {\n  return normalize(q).replace(/\\$/g, '').split(/[^a-z0-9]+/).filter(Boolean).map(t => SYNONYMS.get(t) || t).filter(t => !STOPWORDS.has(t));\n}\nfunction searchProducts(products, query) {\n  var _q$match;\n  const q = normalize(query);\n  const tokens = tokenize(q);\n\n  // Price filters\n  const exactNumber = ((_q$match = q.match(/\\$?(\\d+)/g)) === null || _q$match === void 0 ? void 0 : _q$match.map(n => Number(n)).filter(n => !Number.isNaN(n))) || [];\n  let priceMin = null,\n    priceMax = null;\n  const betweenMatch = q.match(/between\\s*\\$?(\\d+)\\s*(and|to|-)\\s*\\$?(\\d+)/);\n  if (betweenMatch) {\n    const a = Number(betweenMatch[1]);\n    const b = Number(betweenMatch[3]);\n    priceMin = Math.min(a, b);\n    priceMax = Math.max(a, b);\n  } else if (/under|below|less than/.test(q) && exactNumber.length) {\n    priceMax = exactNumber[exactNumber.length - 1];\n  } else if (/over|above|more than/.test(q) && exactNumber.length) {\n    priceMin = exactNumber[exactNumber.length - 1];\n  }\n\n  // Category hints\n  let wantMen = tokens.includes('men');\n  let wantWomen = tokens.includes('women');\n  let wantKid = tokens.includes('kid');\n  if (!wantMen && !wantWomen && !wantKid) {\n    const bc = bestCategory(tokens);\n    if (bc === 'men') wantMen = true;\n    if (bc === 'women') wantWomen = true;\n    if (bc === 'kid') wantKid = true;\n  }\n\n  // Score items\n  const scored = products.map(p => {\n    const name = normalize(`${p.name} ${p.category}`);\n    const words = name.split(/[^a-z0-9]+/).filter(Boolean);\n    let score = 0;\n    if (wantMen && p.category === 'men') score += 3;\n    if (wantWomen && p.category === 'women') score += 3;\n    if (wantKid && p.category === 'kid') score += 3;\n    // direct token hits\n    const directHits = tokens.filter(t => name.includes(t)).length;\n    score += directHits * 2;\n    // fuzzy hits (typo tolerance)\n    for (const t of tokens) {\n      let best = Infinity;\n      for (const w of words) {\n        const d = editDistance(t, w);\n        if (d < best) best = d;\n        if (best === 0) break;\n      }\n      if (best === 1) score += 1; // minor typo\n      if (best === 2 && t.length > 4) score += 0.5; // allow small distance for longer tokens\n    }\n    // hyphen-insensitive tshirt\n    if (tokens.includes('tshirt') && name.includes('t-shirt')) score += 2;\n    return {\n      p,\n      score\n    };\n  });\n\n  // Apply price range filter\n  let filtered = scored.filter(({\n    p\n  }) => {\n    const price = Number(p.new_price);\n    if (priceMin != null && price < priceMin) return false;\n    if (priceMax != null && price > priceMax) return false;\n    return true;\n  });\n\n  // If a category term was present, hard filter to that category\n  if (wantMen || wantWomen || wantKid) {\n    filtered = filtered.filter(({\n      p\n    }) => wantMen && p.category === 'men' || wantWomen && p.category === 'women' || wantKid && p.category === 'kid');\n  }\n\n  // If no tokens after stopword removal, don't overfilterâ€”just return best priced subset if price is specified\n  if (tokens.length === 0 && (priceMin != null || priceMax != null)) {\n    filtered.sort((a, b) => a.p.new_price - b.p.new_price);\n    return filtered.slice(0, 8).map(x => x.p);\n  }\n\n  // Sort by score desc, then price asc\n  filtered.sort((a, b) => b.score - a.score || a.p.new_price - b.p.new_price);\n  return filtered.filter(x => x.score > 0).slice(0, 8).map(x => x.p);\n}\nfunction buildAnswer(query, products) {\n  const q = normalize(query);\n  if (!q.trim()) {\n    return {\n      text: \"Hi! I can help you explore the store. Ask for categories, price ranges, or product names.\",\n      items: []\n    };\n  }\n  if (!products || products.length === 0) {\n    return {\n      text: \"I am loading the catalog. Please try again in a moment or refresh the page.\",\n      items: []\n    };\n  }\n  if (/what\\s+is\\s+(this|the)\\s+(site|website)/.test(q) || /about\\s+this\\s+website/.test(q)) {\n    return {\n      text: \"This is an eâ€‘commerce store for fashion items across Men, Women, and Kids. You can browse categories, compare prices, try items virtually, add to cart, and save favorites in your wishlist.\",\n      items: []\n    };\n  }\n  if (/hello|hi|hey/.test(q)) {\n    return {\n      text: \"Hello! Ask me for products (e.g., 'women tâ€‘shirts under $30') or say a category like 'mens hoodies'.\",\n      items: []\n    };\n  }\n  const results = searchProducts(products, query).slice(0, 6);\n  if (results.length === 0) {\n    // Smart fallback: suggest popular/cheapest in a hinted category or global\n    const tokens = tokenize(q);\n    const wantMen = tokens.includes('men');\n    const wantWomen = tokens.includes('women');\n    const wantKid = tokens.includes('kid');\n    let pool = products;\n    if (wantMen) pool = products.filter(p => p.category === 'men');\n    if (wantWomen) pool = products.filter(p => p.category === 'women');\n    if (wantKid) pool = products.filter(p => p.category === 'kid');\n    const suggestions = [...pool].sort((a, b) => a.new_price - b.new_price).slice(0, 6);\n    if (suggestions.length) {\n      return {\n        text: \"I couldn't find an exact match. Here are some close suggestions:\",\n        items: suggestions\n      };\n    }\n    return {\n      text: \"I couldn't find matching items. Try changing the category or price range.\",\n      items: []\n    };\n  }\n  return {\n    text: `Here are some matches (${results.length} shown):`,\n    items: results\n  };\n}\nexport const Chatbot = () => {\n  _s();\n  const {\n    all_product\n  } = useContext(ShopContext);\n  const {\n    toggleWishlist,\n    isWishlisted\n  } = useContext(WishlistContext);\n  const [open, setOpen] = useState(false);\n  const [input, setInput] = useState('');\n  const [messages, setMessages] = useState([{\n    role: 'system',\n    content: systemPrompts[0]\n  }, {\n    role: 'assistant',\n    content: 'Hi! I\\'m your shopping assistant. How can I help?'\n  }]);\n  const listRef = useRef(null);\n  const [thinking, setThinking] = useState(false);\n  const [context, setContext] = useState({\n    lastCategory: null,\n    lastPriceMin: null,\n    lastPriceMax: null\n  });\n  const handleAsk = () => {\n    const q = input.trim();\n    if (!q) return;\n    const userMsg = {\n      role: 'user',\n      content: q\n    };\n    setMessages(prev => [...prev, userMsg]);\n    setThinking(true);\n    setInput('');\n    setTimeout(() => {\n      const answer = buildAnswer(q, all_product);\n      const botMsg = {\n        role: 'assistant',\n        content: answer.text,\n        items: answer.items\n      };\n      setMessages(prev => [...prev, botMsg]);\n      setThinking(false);\n      setTimeout(() => {\n        if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n      }, 0);\n    }, 150); // brief delay for UX\n  };\n  const quickChips = useMemo(() => ['Show women t-shirts under $30', 'mens hoodies', 'kids shoes between $20 and $50', 'what is this website?'], []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chatbot-root\",\n    children: [!open && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"chatbot-fab\",\n      onClick: () => setOpen(true),\n      \"aria-label\": \"Open assistant\",\n      children: \"\\uD83D\\uDCAC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }, this), open && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatbot-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Shop Assistant\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"chatbot-close\",\n          onClick: () => setOpen(false),\n          \"aria-label\": \"Close\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-body\",\n        ref: listRef,\n        children: [messages.map((m, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `msg msg-${m.role}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"msg-text\",\n            children: m.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 17\n          }, this), Array.isArray(m.items) && m.items.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"results\",\n            children: m.items.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"result-card\",\n              children: [/*#__PURE__*/_jsxDEV(Link, {\n                to: `/product/${item.id}`,\n                className: \"rc-link\",\n                onClick: () => setOpen(false),\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.image,\n                  alt: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rc-meta\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rc-name\",\n                    children: item.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 242,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rc-price\",\n                    children: [\"$\", item.new_price]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 243,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"rc-wish\",\n                onClick: () => toggleWishlist(item.id),\n                \"aria-label\": isWishlisted(item.id) ? 'Remove from wishlist' : 'Add to wishlist',\n                children: isWishlisted(item.id) ? 'â™¥' : 'â™¡'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 25\n              }, this)]\n            }, item.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 23\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 19\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 15\n        }, this)), thinking && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"msg msg-assistant\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"msg-text\",\n            children: \"Thinking\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 50\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-chips\",\n        children: quickChips.map(c => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"chip\",\n          onClick: () => {\n            setInput(c);\n          },\n          children: c\n        }, c, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-input\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: input,\n          onChange: e => setInput(e.target.value),\n          placeholder: \"Ask about products, categories, or price...\",\n          onKeyDown: e => {\n            if (e.key === 'Enter') handleAsk();\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleAsk,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 219,\n    columnNumber: 5\n  }, this);\n};\n_s(Chatbot, \"ZYMczpIUoQtzwUnltWI03mnjDdI=\");\n_c = Chatbot;\nexport default Chatbot;\nvar _c;\n$RefreshReg$(_c, \"Chatbot\");","map":{"version":3,"names":["React","useContext","useMemo","useRef","useState","ShopContext","Link","WishlistContext","jsxDEV","_jsxDEV","systemPrompts","normalize","s","String","toLowerCase","STOPWORDS","Set","SYNONYMS","Map","CATEGORY_TERMS","editDistance","a","b","dp","Array","length","fill","map","_","i","j","Math","min","bestCategory","tokens","best","bestScore","Infinity","t","cat","d","tokenize","q","replace","split","filter","Boolean","get","has","searchProducts","products","query","_q$match","exactNumber","match","n","Number","isNaN","priceMin","priceMax","betweenMatch","max","test","wantMen","includes","wantWomen","wantKid","bc","scored","p","name","category","words","score","directHits","w","filtered","price","new_price","sort","slice","x","buildAnswer","trim","text","items","results","pool","suggestions","Chatbot","_s","all_product","toggleWishlist","isWishlisted","open","setOpen","input","setInput","messages","setMessages","role","content","listRef","thinking","setThinking","context","setContext","lastCategory","lastPriceMin","lastPriceMax","handleAsk","userMsg","prev","setTimeout","answer","botMsg","current","scrollTop","scrollHeight","quickChips","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","m","idx","isArray","item","to","id","src","image","alt","c","value","onChange","e","target","placeholder","onKeyDown","key","_c","$RefreshReg$"],"sources":["D:/ec/E_Commerence/frontend/src/Components/Chatbot/Chatbot.jsx"],"sourcesContent":["import React, { useContext, useMemo, useRef, useState } from 'react';\nimport './Chatbot.css';\nimport { ShopContext } from '../../Context/ShopContext';\nimport { Link } from 'react-router-dom';\nimport { WishlistContext } from '../../Context/WishlistContext';\n\nconst systemPrompts = [\n  'Ask me about products, categories, prices, or style tips. Try: \"Show women t-shirts under $30\" or \"What is this site about?\"'\n];\n\nconst normalize = (s) => String(s || '').toLowerCase();\nconst STOPWORDS = new Set(['show','me','the','a','an','to','and','or','for','with','please','site','website','this','is','about','under','below','between','than','less','more','of','at','in','some','any','do','you','have']);\nconst SYNONYMS = new Map([\n  ['tshirt','t-shirt'], ['tshirts','t-shirt'], ['tee','t-shirt'],\n  ['hoodies','hoodie'], ['hoodie','hoodie'],\n  ['shoe','shoes'], ['sneaker','shoes'], ['sneakers','shoes'],\n  ['sandal','shoes'], ['sandals','shoes'], ['trainer','shoes'], ['trainers','shoes'],\n  ['jeans','jeans'], ['denim','jeans'], ['trouser','pants'], ['trousers','pants'], ['pant','pants'], ['pants','pants'],\n  ['shirt','shirt'], ['shirts','shirt'], ['top','top'], ['tops','top'], ['dress','dress'], ['dresses','dress'], ['skirt','skirt'], ['skirts','skirt'], ['jacket','jacket'], ['jackets','jacket'],\n  ['women','women'], ['womens','women'], [\"women's\",'women'],\n  ['men','men'], ['mens','men'], [\"men's\",'men'],\n  ['kid','kid'], ['kids','kid'],\n]);\n\nconst CATEGORY_TERMS = ['men','women','kid'];\n\nfunction editDistance(a,b){\n  a = a || ''; b = b || '';\n  const dp = Array(b.length+1).fill(0).map((_,i)=>[i]);\n  for(let j=0;j<=a.length;j++){ dp[0][j]=j; }\n  for(let i=1;i<=b.length;i++){\n    for(let j=1;j<=a.length;j++){\n      dp[i][j] = Math.min(\n        dp[i-1][j] + 1,\n        dp[i][j-1] + 1,\n        dp[i-1][j-1] + (a[j-1]===b[i-1]?0:1)\n      );\n    }\n  }\n  return dp[b.length][a.length];\n}\n\nfunction bestCategory(tokens){\n  let best = null, bestScore = Infinity;\n  for(const t of tokens){\n    for(const cat of CATEGORY_TERMS){\n      const d = editDistance(t, cat);\n      if(d < bestScore){ bestScore = d; best = cat; }\n    }\n  }\n  return bestScore <= 2 ? best : null; // tolerate small typos\n}\n\nfunction tokenize(q){\n  return normalize(q)\n    .replace(/\\$/g,'')\n    .split(/[^a-z0-9]+/)\n    .filter(Boolean)\n    .map(t=>SYNONYMS.get(t) || t)\n    .filter(t=>!STOPWORDS.has(t));\n}\n\nfunction searchProducts(products, query) {\n  const q = normalize(query);\n  const tokens = tokenize(q);\n\n  // Price filters\n  const exactNumber = q.match(/\\$?(\\d+)/g)?.map(n=>Number(n)).filter(n=>!Number.isNaN(n)) || [];\n  let priceMin = null, priceMax = null;\n  const betweenMatch = q.match(/between\\s*\\$?(\\d+)\\s*(and|to|-)\\s*\\$?(\\d+)/);\n  if (betweenMatch) {\n    const a = Number(betweenMatch[1]);\n    const b = Number(betweenMatch[3]);\n    priceMin = Math.min(a,b); priceMax = Math.max(a,b);\n  } else if (/under|below|less than/.test(q) && exactNumber.length){\n    priceMax = exactNumber[exactNumber.length-1];\n  } else if (/over|above|more than/.test(q) && exactNumber.length){\n    priceMin = exactNumber[exactNumber.length-1];\n  }\n\n  // Category hints\n  let wantMen = tokens.includes('men');\n  let wantWomen = tokens.includes('women');\n  let wantKid = tokens.includes('kid');\n  if(!wantMen && !wantWomen && !wantKid){\n    const bc = bestCategory(tokens);\n    if (bc==='men') wantMen = true;\n    if (bc==='women') wantWomen = true;\n    if (bc==='kid') wantKid = true;\n  }\n\n  // Score items\n  const scored = products.map(p=>{\n    const name = normalize(`${p.name} ${p.category}`);\n    const words = name.split(/[^a-z0-9]+/).filter(Boolean);\n    let score = 0;\n    if (wantMen && p.category === 'men') score += 3;\n    if (wantWomen && p.category === 'women') score += 3;\n    if (wantKid && p.category === 'kid') score += 3;\n    // direct token hits\n    const directHits = tokens.filter(t=>name.includes(t)).length;\n    score += directHits * 2;\n    // fuzzy hits (typo tolerance)\n    for (const t of tokens){\n      let best = Infinity;\n      for (const w of words){\n        const d = editDistance(t, w);\n        if (d < best) best = d;\n        if (best === 0) break;\n      }\n      if (best === 1) score += 1; // minor typo\n      if (best === 2 && t.length > 4) score += 0.5; // allow small distance for longer tokens\n    }\n    // hyphen-insensitive tshirt\n    if (tokens.includes('tshirt') && name.includes('t-shirt')) score += 2;\n    return { p, score };\n  });\n\n  // Apply price range filter\n  let filtered = scored.filter(({p})=>{\n    const price = Number(p.new_price);\n    if (priceMin!=null && price < priceMin) return false;\n    if (priceMax!=null && price > priceMax) return false;\n    return true;\n  });\n\n  // If a category term was present, hard filter to that category\n  if (wantMen || wantWomen || wantKid){\n    filtered = filtered.filter(({p})=>\n      (wantMen && p.category==='men') || (wantWomen && p.category==='women') || (wantKid && p.category==='kid')\n    );\n  }\n\n  // If no tokens after stopword removal, don't overfilterâ€”just return best priced subset if price is specified\n  if (tokens.length === 0 && (priceMin!=null || priceMax!=null)){\n    filtered.sort((a,b)=> (a.p.new_price - b.p.new_price));\n    return filtered.slice(0,8).map(x=>x.p);\n  }\n\n  // Sort by score desc, then price asc\n  filtered.sort((a,b)=> b.score - a.score || (a.p.new_price - b.p.new_price));\n  return filtered.filter(x=>x.score>0).slice(0,8).map(x=>x.p);\n}\n\nfunction buildAnswer(query, products) {\n  const q = normalize(query);\n  if (!q.trim()) {\n    return { text: \"Hi! I can help you explore the store. Ask for categories, price ranges, or product names.\", items: [] };\n  }\n  if (!products || products.length === 0){\n    return { text: \"I am loading the catalog. Please try again in a moment or refresh the page.\", items: [] };\n  }\n  if (/what\\s+is\\s+(this|the)\\s+(site|website)/.test(q) || /about\\s+this\\s+website/.test(q)) {\n    return { text: \"This is an eâ€‘commerce store for fashion items across Men, Women, and Kids. You can browse categories, compare prices, try items virtually, add to cart, and save favorites in your wishlist.\", items: [] };\n  }\n  if (/hello|hi|hey/.test(q)) {\n    return { text: \"Hello! Ask me for products (e.g., 'women tâ€‘shirts under $30') or say a category like 'mens hoodies'.\", items: [] };\n  }\n\n  const results = searchProducts(products, query).slice(0, 6);\n  if (results.length === 0) {\n    // Smart fallback: suggest popular/cheapest in a hinted category or global\n    const tokens = tokenize(q);\n    const wantMen = tokens.includes('men');\n    const wantWomen = tokens.includes('women');\n    const wantKid = tokens.includes('kid');\n    let pool = products;\n    if (wantMen) pool = products.filter(p=>p.category==='men');\n    if (wantWomen) pool = products.filter(p=>p.category==='women');\n    if (wantKid) pool = products.filter(p=>p.category==='kid');\n    const suggestions = [...pool].sort((a,b)=> (a.new_price - b.new_price)).slice(0,6);\n    if (suggestions.length){\n      return { text: \"I couldn't find an exact match. Here are some close suggestions:\", items: suggestions };\n    }\n    return { text: \"I couldn't find matching items. Try changing the category or price range.\", items: [] };\n  }\n  return { text: `Here are some matches (${results.length} shown):`, items: results };\n}\n\nexport const Chatbot = () => {\n  const { all_product } = useContext(ShopContext);\n  const { toggleWishlist, isWishlisted } = useContext(WishlistContext);\n  const [open, setOpen] = useState(false);\n  const [input, setInput] = useState('');\n  const [messages, setMessages] = useState([\n    { role: 'system', content: systemPrompts[0] },\n    { role: 'assistant', content: 'Hi! I\\'m your shopping assistant. How can I help?' }\n  ]);\n  const listRef = useRef(null);\n  const [thinking, setThinking] = useState(false);\n  const [context, setContext] = useState({ lastCategory: null, lastPriceMin: null, lastPriceMax: null });\n\n  const handleAsk = () => {\n    const q = input.trim();\n    if (!q) return;\n    const userMsg = { role: 'user', content: q };\n    setMessages(prev => [...prev, userMsg]);\n    setThinking(true);\n    setInput('');\n    setTimeout(() => {\n      const answer = buildAnswer(q, all_product);\n      const botMsg = { role: 'assistant', content: answer.text, items: answer.items };\n      setMessages(prev => [...prev, botMsg]);\n      setThinking(false);\n      setTimeout(() => {\n        if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n      }, 0);\n    }, 150); // brief delay for UX\n  };\n\n  const quickChips = useMemo(() => [\n    'Show women t-shirts under $30',\n    'mens hoodies',\n    'kids shoes between $20 and $50',\n    'what is this website?',\n  ], []);\n\n  return (\n    <div className=\"chatbot-root\">\n      {!open && (\n        <button className=\"chatbot-fab\" onClick={() => setOpen(true)} aria-label=\"Open assistant\">\n          ðŸ’¬\n        </button>\n      )}\n      {open && (\n        <div className=\"chatbot-panel\">\n          <div className=\"chatbot-header\">\n            <strong>Shop Assistant</strong>\n            <button className=\"chatbot-close\" onClick={() => setOpen(false)} aria-label=\"Close\">Ã—</button>\n          </div>\n          <div className=\"chatbot-body\" ref={listRef}>\n            {messages.map((m, idx) => (\n              <div key={idx} className={`msg msg-${m.role}`}>\n                <div className=\"msg-text\">{m.content}</div>\n                {Array.isArray(m.items) && m.items.length > 0 && (\n                  <div className=\"results\">\n                    {m.items.map(item => (\n                      <div key={item.id} className=\"result-card\">\n                        <Link to={`/product/${item.id}`} className=\"rc-link\" onClick={() => setOpen(false)}>\n                          <img src={item.image} alt={item.name} />\n                          <div className=\"rc-meta\">\n                            <div className=\"rc-name\">{item.name}</div>\n                            <div className=\"rc-price\">${item.new_price}</div>\n                          </div>\n                        </Link>\n                        <button\n                          className=\"rc-wish\"\n                          onClick={() => toggleWishlist(item.id)}\n                          aria-label={isWishlisted(item.id) ? 'Remove from wishlist' : 'Add to wishlist'}\n                        >\n                          {isWishlisted(item.id) ? 'â™¥' : 'â™¡'}\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))}\n            {thinking && (\n              <div className=\"msg msg-assistant\"><div className=\"msg-text\">Thinkingâ€¦</div></div>\n            )}\n          </div>\n          <div className=\"chatbot-chips\">\n            {quickChips.map((c) => (\n              <button key={c} className=\"chip\" onClick={() => { setInput(c); }}>\n                {c}\n              </button>\n            ))}\n          </div>\n          <div className=\"chatbot-input\">\n            <input\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              placeholder=\"Ask about products, categories, or price...\"\n              onKeyDown={(e) => { if (e.key === 'Enter') handleAsk(); }}\n            />\n            <button onClick={handleAsk}>Send</button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Chatbot;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}